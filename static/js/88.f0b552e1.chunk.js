"use strict";(self.webpackChunkboxxerworld_customiser=self.webpackChunkboxxerworld_customiser||[]).push([[88],{9088:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Kt});var a=i(4875),n=i(1418),l=i.n(n),s=i(6042),o=i(3791),r=i(2791);const d=e=>{const[t,i]=(0,r.useState)(!1),a=(0,r.useRef)(null);return(0,r.useEffect)((()=>{t||(a.current=document.getElementById(e),a.current&&i(!0))}),[e,t]),t?a.current:null};var c=i(4164);const u="NavButtons_root__ON-jJ",v="DontShowAgain_root__zOI6r",h="DontShowAgain_notifContainer__adaGf",m="DontShowAgain_notifControlContainer__gVQq0",p="DontShowAgain_btnContainer__We3vg";var x=i(184);const g=e=>{let{children:t,notifName:i="hideShowNotification",setShowNotification:a,cb:n}=e;const[l,s]=(0,r.useState)(!1),o=()=>{a(!1),l&&localStorage.setItem(i,"1")};return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{className:v,children:(0,x.jsxs)("span",{className:h,children:[t,(0,x.jsxs)("div",{className:m,children:[(0,x.jsxs)("label",{children:[(0,x.jsx)("input",{type:"checkbox",onChange:e=>s(e.target.checked)}),"Don't show again"]}),(0,x.jsxs)("span",{className:p,children:[(0,x.jsx)("button",{onClick:o,children:"Cancel"}),(0,x.jsx)("button",{onClick:()=>{o(),n&&n()},children:"Okay"})]})]})]})})})};var f=i(7002);const _=e=>{let{onClick:t,isClickable:i,classNames:a,children:n}=e;const l="\n      ".concat(f.Z.containedButton,"\n      ").concat(a,"\n      ").concat("undefined"===typeof i||i?f.Z.clickable:"","\n    ");return(0,x.jsx)("button",{className:l,onClick:t,children:n})},C=e=>{var t;let{finishedNavs:i,className:n,confirmText:s,confirmStorage:o,onNext:v}=e;const h=l()(u,n),{navItems:m,selectedNav:p,parts:f,sizing:C,cancelPartChange:y,resetNav:j,setSelectedNav:N}=(0,a.b)(),b=m.findIndex((e=>e.name===(null===p||void 0===p?void 0:p.name))),T=d("CustomiserNavActions"),k=d("popupContainer"),[S,w]=(0,r.useState)(!1),P=o,I=!localStorage.getItem(P||"");let M=f.map((e=>{const t=e.part.name;if(!t)return;const i=!!m.find((e=>e.name===t));return{name:t,isFinished:i}}));i&&i.length&&(M=[...M,...i]);let F=!(!p||null===(t=M.find((e=>(null===e||void 0===e?void 0:e.name)===p.name)))||void 0===t||!t.isFinished),O=null===p||void 0===p?void 0:p.required;if("Fitting"===(null===p||void 0===p?void 0:p.name))O=!1;else if("Size"===(null===p||void 0===p?void 0:p.name)){var B,z;F=!(null===C||void 0===C||null===(B=C.height)||void 0===B||!B.value||null===C||void 0===C||null===(z=C.weight)||void 0===z||!z.value)}return T&&k?c.createPortal((0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:h,children:[(0,x.jsx)(_,{onClick:()=>y(),children:"Cancel"}),v?(0,x.jsx)(_,{onClick:v,children:"Next"}):(0,x.jsx)(_,{isClickable:!O||F,onClick:()=>{-1!==b&&F&&N(b+1)},children:"Save"})]}),s&&S&&I&&P&&c.createPortal((0,x.jsx)(g,{cb:j,setShowNotification:w,notifName:P,children:(0,x.jsx)("span",{children:s})}),k)]}),T):null},y={fittingOption:"NavFitting_fittingOption__XQUUG",fittingButtons:"NavFitting_fittingButtons__Y1hdd",fittingButton:"NavFitting_fittingButton__djmDJ",navButtonContainer:"NavFitting_navButtonContainer__K9a4D"},j=e=>{let{onClick:t,isClickable:i,isSelected:a,isFinished:n,classNames:l,children:s}=e;const o="\n    ".concat(f.Z.capsuleNavButton,"\n    ").concat(l,"\n    ").concat(a?f.Z.selected:"","\n    ").concat(n?f.Z.finished:"","\n    ");return(0,x.jsx)("span",{className:o,onClick:t,children:s})},N=e=>{let{onClick:t,isSelected:i,isFinished:a,classNames:n,children:l}=e;const s="\n    ".concat(f.Z.containedNavButton,"\n    ").concat(n,"\n    ").concat(i?f.Z.selected:"","\n    ").concat(a?f.Z.finished:"","\n    ");return(0,x.jsx)("span",{className:s,onClick:t,children:l})},b=e=>{var t,i;let{option:n,focusCameraOnPart:l}=e;const o=(0,a.b)((e=>e.selectedModels)),r=(0,a.b)((e=>e.setSelectedModel));if(!n)return null;const d=null===(t=o.find((e=>e.optionId===n.id)))||void 0===t?void 0:t.model;return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(s.E.div,{className:y.fittingOption,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,x.jsx)("div",{className:y.fittingButtons,children:null===(i=n.models)||void 0===i?void 0:i.map((e=>{var t,i,a,s,o;return(0,x.jsx)(N,{isSelected:(null===d||void 0===d?void 0:d.id)===(null===e||void 0===e||null===(t=e.model)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.id),classNames:y.fittingButton,onClick:()=>{var t;r(n.id,null===e||void 0===e||null===(t=e.model)||void 0===t?void 0:t.data),l&&l(n.name)},children:null===e||void 0===e||null===(a=e.model)||void 0===a||null===(s=a.data)||void 0===s||null===(o=s.attributes)||void 0===o?void 0:o.name},null===e||void 0===e?void 0:e.id)}))})})})},T=e=>{var t;let{focusCameraOnPart:i,finishedNavs:n,setFinishedNavs:l}=e;const s=(0,a.b)((e=>{var t,i;return null===(t=e.customProduct)||void 0===t||null===(i=t.attributes)||void 0===i?void 0:i.options})),o=null===s||void 0===s?void 0:s.map((e=>e.name)),d=null!==n&&void 0!==n&&n.find((e=>"Fitting"===(null===e||void 0===e?void 0:e.name)&&!0===e.isFinished))?s.length-1:0,[c,u]=(0,r.useState)(d),v=c<s.length-1;return(0,r.useEffect)((()=>{v||l&&l((e=>{const t=e.findIndex((e=>"Fitting"===(null===e||void 0===e?void 0:e.name)));return-1!==t?(e[t]={name:"Fitting",isFinished:!0},e):[...e,{name:"Fitting",isFinished:!0}]}))}),[c]),(0,x.jsxs)("div",{className:y.root,children:[(0,x.jsx)("div",{className:y.navButtonContainer,children:o.map(((e,t)=>(0,x.jsx)(j,{isFinished:c>t,isSelected:c===t,onClick:()=>u(t),children:e},t)))}),(0,x.jsx)("div",{children:(0,x.jsxs)("b",{children:["Select ",o[c],":"]})}),(0,x.jsx)("br",{}),(0,x.jsx)(b,{focusCameraOnPart:i,option:s[c]},null===(t=s[c])||void 0===t?void 0:t.id),(0,x.jsx)(C,{onNext:v&&(()=>{u((e=>e+1))}),finishedNavs:n})]})};function k(e){return function(e){if(!e)return null;const t=Object.entries(e).map((e=>e[1]?{width:e[1].width,url:e[1].url}:null)).filter((e=>e));return t.length?t.sort(((e,t)=>null!==e&&void 0!==e&&e.width&&null!==t&&void 0!==t&&t.width&&e.width<t.width?-1:null!==e&&void 0!==e&&e.width&&null!==t&&void 0!==t&&t.width&&e.width>t.width?1:0)).reduce(((e,t,i,a)=>e+"".concat(t.url," ").concat(t.width,"w").concat(i<a.length-1?", ":"")),""):null}(e)}const S="Image_root__u7aDb",w=e=>{var t;let{className:i,image:a,sizes:n}=e;const s=l()(S,i);if(!a)return null;const o=(0,r.useMemo)((()=>{var e,t;return null!==(e=a.attributes)&&void 0!==e&&e.height&&null!==(t=a.attributes)&&void 0!==t&&t.width?a.attributes.height/a.attributes.width*100:100}),[a]),d={"--image-padding-top":"".concat(o,"%")},c=(0,r.useMemo)((()=>{var e;return k(null===(e=a.attributes)||void 0===e?void 0:e.formats)}),[a]);return(0,x.jsx)("div",{className:s,style:d,children:c&&(0,x.jsx)("img",{src:null===(t=a.attributes)||void 0===t?void 0:t.url,srcSet:c,sizes:n||"100vw"})})},P={flags:"NavFlags_flags__S52CT",flag:"NavFlags_flag__gtrVs",flagItem:"NavFlags_flagItem__rI7sv",flagItemImage:"NavFlags_flagItemImage__6ov2x"},I=e=>{let{editFlag:t,flags:i}=e;const{addFlag:n,updateFlag:l}=(0,a.b)((e=>e));return(0,x.jsx)("div",{className:P.flags,children:null===i||void 0===i?void 0:i.map((e=>{var i;return(0,x.jsx)("div",{className:P.flag,onClick:()=>{return i=e,void(null!==t&&void 0!==t&&t.key?l(t.key,{flag:i,edit:!0}):n({flag:i}));var i},children:(0,x.jsx)(w,{image:null===(i=e.attributes)||void 0===i?void 0:i.image.data})},e.id)}))})};var M=i(2656);const F="NavDecalAdjust_root__t6vBt",O="NavDecalAdjust_root__rotate__jXeZv",B="NavDecalAdjust_iconContainer__nW-8U",z="NavDecalAdjust_rotateIcon__fOqK4";var G=i(2924),E=i(9200);const H=e=>{var t;let{className:i,scale:a=1,rotation:n=0,prices:s,onScale:o,onRotate:u}=e;const v=.15,h=7.5,m=d("CustomiserCanvasControls"),[p,g]=(0,r.useState)(a),[f,_]=(0,r.useState)(n);if(!m)return null;const C=l()(F,i,O),y=((e,t,i)=>Array.from({length:(t-e)/i+1},((t,a)=>e+a*i)))(1,2,1/((null!==(t=null===s||void 0===s?void 0:s.length)&&void 0!==t?t:10)-1));null===s||void 0===s||s.map(((e,t)=>({...e,markKey:Number(y[t].toFixed(5))})));return(0,c.createPortal)((0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:C,children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("h4",{children:"Size"}),(0,x.jsxs)("span",{className:B,children:[(0,x.jsx)("span",{onClick:()=>{g((e=>e-v<=0?e:(o&&o(e-v),e-v)))},children:(0,x.jsx)(G.mns,{})}),(0,x.jsx)("span",{onClick:()=>{g((e=>(o&&o(e+v),e+v)))},children:(0,x.jsx)(G.FKX,{})})]})]}),(0,x.jsxs)("span",{children:[(0,x.jsx)("h4",{children:"Rotate"}),(0,x.jsxs)("span",{className:B,children:[(0,x.jsx)("span",{className:z,onClick:()=>{_((e=>(u&&u(e+h),e+h)))},children:(0,x.jsx)(E.E$8,{})}),(0,x.jsx)("span",{className:z,onClick:()=>{_((e=>(u&&u(e-h),e-h)))},children:(0,x.jsx)(E.jFC,{})})]})]})]})}),m)},L="NavEditButtons_root__43Hm3",A=e=>{let{className:t,disabled:i,onApply:a}=e;const n=l()(L,t),s=d("CustomiserNavActions");return s?c.createPortal((0,x.jsxs)("div",{className:n,children:[(0,x.jsx)(M.Z,{onClick:a,children:"Canacel"}),(0,x.jsx)(M.Z,{colour:"red",onClick:a,disabled:i,children:"Save"})]}),s):null},V="NavOptionEdit_root__q-pp0",Z="NavOptionEdit_eyeIcon__v85fP",D=e=>{let{className:t,onEdit:i,onDelete:a,isVisible:n=!0,toggleVisibility:s}=e;const o=l()(V,t),r=void 0===typeof n||n;return(0,x.jsxs)("div",{className:o,children:[(0,x.jsx)("span",{onClick:e=>{e.stopPropagation(),s&&s()},className:Z,children:r?(0,x.jsx)(G.dSq,{}):(0,x.jsx)(G.tgn,{})}),(0,x.jsx)("button",{onClick:i,children:(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24.785 24.788",children:(0,x.jsx)("path",{d:"M24.785 6.739 18.046 0 0 18.049v6.739h6.739Zm-6.738-3.218 3.218 3.218-1.351 1.352-3.217-3.218Zm-3.112 3.112 3.218 3.218L7.467 20.538l-3.218-3.22ZM2.489 22.298v-3.219l3.218 3.218Z"})})}),(0,x.jsx)("button",{onClick:a,children:(0,x.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 23.601 23.219",children:[(0,x.jsx)("path",{d:"m14.601 11.609-1.489-1.489L2.992 0 .001 2.978l8.631 8.631-8.631 8.632 2.991 2.978L13.112 13.1Z"}),(0,x.jsx)("path",{d:"m9 11.609 1.489 1.489 10.12 10.12L23.6 20.24l-8.631-8.631L23.6 2.977 20.609-.001l-10.12 10.119Z"})]})})]})},R=e=>{var t,i;let{flag:n,setShowSelector:l}=e;const{updateFlag:s,deleteFlag:o}=(0,a.b)((e=>e));return(0,x.jsxs)("div",{className:P.flagItem,children:[(0,x.jsx)("div",{className:P.flagItemImage,children:(0,x.jsx)(w,{image:null===(t=n.flag)||void 0===t||null===(i=t.attributes)||void 0===i?void 0:i.image.data})}),(0,x.jsx)(D,{onEdit:()=>{n.key&&s(n.key,{edit:!0}),l(!0)},onDelete:()=>{n.key&&o(n.key)}})]})};var W=i(8148),q=i(1854);const X=()=>{const e=(0,a.b)((e=>e.flags)),t=(0,a.b)((e=>e.updateFlag)),i=null===e||void 0===e?void 0:e.find((e=>e.edit)),[n,l]=(0,r.useState)(!1),{data:s}=(0,W.nY)(q.SL,{pagination:{limit:500}},{select:e=>{var t,i;return{flags:null===(t=e.flags)||void 0===t?void 0:t.data,prices:null===(i=e.graphicPrices)||void 0===i?void 0:i.data}}});return(0,x.jsx)(x.Fragment,{children:n?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(H,{scale:null===i||void 0===i?void 0:i.decalScale,rotation:null===i||void 0===i?void 0:i.decalRotation,onScale:(e,a)=>{var n,l;const s=null!==a&&void 0!==a&&null!==(n=a.attributes)&&void 0!==n&&n.size&&null!==a&&void 0!==a&&null!==(l=a.attributes)&&void 0!==l&&l.basePrice?{size:a.attributes.size,basePrice:{...a.attributes.basePrice,quantity:1}}:{};null!==i&&void 0!==i&&i.key&&t(i.key,{decalScale:Number(e),...s})},onRotate:e=>{(0,r.startTransition)((()=>{null!==i&&void 0!==i&&i.key&&t(i.key,{decalRotation:Number(e)})}))},prices:null===s||void 0===s?void 0:s.prices}),(null===s||void 0===s?void 0:s.flags)&&(0,x.jsx)(I,{editFlag:i,flags:s.flags}),(0,x.jsx)(A,{disabled:!i,onApply:()=>{null!==i&&void 0!==i&&i.key&&t(i.key,{decalFreeze:!1,edit:!1}),l(!1)}})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:P.customiserFlags,children:[(0,x.jsx)("h3",{children:"Your Flags"}),null===e||void 0===e?void 0:e.map((e=>(0,x.jsx)(R,{flag:e,setShowSelector:l},e.key))),(0,x.jsx)(M.Z,{colour:"red",onClick:()=>{l(!0)},children:"Add Flag"})]}),(0,x.jsx)(C,{})]})})},U="NavHeader_root__jnadG",Y="NavHeader_nav__mJbli",K="NavHeader_minimizeIcon__GKC2n",Q="NavHeader_minimized__04mp3",J=e=>{let{className:t,toggle:i,isOpen:n,isMinimized:s=!1,onClick:o}=e;const r=l()(U,t);(0,a.b)((e=>e.selectedNav));if(n)return null;const d=l()(K,{[Q]:s});return(0,x.jsx)(x.Fragment,{children:(0,x.jsx)("div",{id:"NavHeader",className:r,children:(0,x.jsx)("div",{className:Y,children:(0,x.jsx)("div",{className:d,onClick:o,children:(0,x.jsx)("svg",{viewBox:"0 0 330 330",children:(0,x.jsx)("path",{xmlns:"http://www.w3.org/2000/svg",id:"XMLID_224_",d:"M325.606,229.393l-150.004-150C172.79,76.58,168.974,75,164.996,75c-3.979,0-7.794,1.581-10.607,4.394  l-149.996,150c-5.858,5.858-5.858,15.355,0,21.213c5.857,5.857,15.355,5.858,21.213,0l139.39-139.393l139.397,139.393  C307.322,253.536,311.161,255,315,255c3.839,0,7.678-1.464,10.607-4.394C331.464,244.748,331.464,235.251,325.606,229.393z"})})})})})})},$={dropZone:"NavImages_dropZone__4YMrM",image:"NavImages_image__svpqZ",graphicItem:"NavImages_graphicItem__XenKS",graphicItemImage:"NavImages_graphicItemImage__8GS2T"},ee=e=>{var t,i,n;let{graphic:l,setShowSelector:s}=e;const{updateGraphic:o,deleteGraphic:r}=(0,a.b)((e=>e));return(0,x.jsxs)("div",{className:$.graphicItem,children:[(0,x.jsx)("div",{className:$.graphicItemImage,children:(0,x.jsx)(w,{image:null===(t=l.graphic)||void 0===t||null===(i=t.attributes)||void 0===i||null===(n=i.image)||void 0===n?void 0:n.data})}),(0,x.jsx)(D,{onEdit:()=>{l.key&&o(l.key,{edit:!0}),s(!0)},onDelete:()=>{l.key&&r(l.key)}})]})};var te=i(7831);const ie=e=>{let{setGraphic:t}=e;const[i,a]=(0,r.useState)(!1),{mutate:n}=(0,W.Zn)(q.SL,{onSuccess(e){var i;const n=null===(i=e.createGraphic)||void 0===i?void 0:i.data;a(!1),n&&t(n)}}),{mutate:l}=(0,W.a1)(q.SL,{onSuccess(e){const t=e.multipleUpload.map((e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.id}));n({data:{image:t[0],customer:!0,name:t[0]}})}}),s=(0,r.useCallback)((e=>{a(!0),l({files:e})}),[]),{getRootProps:o,getInputProps:d,isDragActive:c}=(0,te.uI)({onDrop:s,accept:{"image/jpeg":[],"image/png":[]},maxFiles:1,multiple:!1});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h5",{children:"Upload an image"}),(0,x.jsxs)("div",{className:$.dropZone,...o(),children:[(0,x.jsx)("input",{...d()}),(0,x.jsxs)("div",{children:[(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 23.219 29.191",children:(0,x.jsxs)("g",{children:[(0,x.jsx)("path",{d:"M11.609 0 10.12 1.489 0 11.609 2.978 14.6l8.631-8.631 8.632 8.631 2.978-2.991L13.1 1.489Z"}),(0,x.jsx)("path",{d:"M14.356 29.191h-5v-26h5Z"})]})}),i?(0,x.jsx)("h5",{children:"Please wait..."}):c?(0,x.jsx)("h5",{children:"Drop images here ..."}):(0,x.jsx)("h5",{children:"Click or drag images here to upload"})]})]})]})},ae=e=>{var t,i;let{editGraphic:n,graphic:l}=e;const[s,o]=(0,r.useState)(l),{addGraphic:d,updateGraphic:c}=(0,a.b)((e=>e));return(0,x.jsx)("div",{className:$.graphics,children:s?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(w,{className:$.image,image:null===(t=s.attributes)||void 0===t||null===(i=t.image)||void 0===i?void 0:i.data}),(0,x.jsx)(M.Z,{onClick:()=>o(void 0),children:"Change Image"})]}):(0,x.jsx)(ie,{setGraphic:e=>{o(e),(e=>{null!==n&&void 0!==n&&n.key?c(n.key,{graphic:e,edit:!0}):d({graphic:e})})(e)}})})},ne=()=>{const[e,t]=(0,r.useState)(!1),i=(0,a.b)((e=>e.graphics)),n=(0,a.b)((e=>e.updateGraphic)),l=null===i||void 0===i?void 0:i.find((e=>e.edit)),{data:s}=(0,W.Nn)(q.SL,{},{select:e=>{var t;return{prices:null===(t=e.graphicPrices)||void 0===t?void 0:t.data}}});return(0,x.jsx)(x.Fragment,{children:e?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(H,{scale:null===l||void 0===l?void 0:l.decalScale,rotation:null===l||void 0===l?void 0:l.decalRotation,onScale:(e,t)=>{var i,a;const s=null!==t&&void 0!==t&&null!==(i=t.attributes)&&void 0!==i&&i.size&&null!==t&&void 0!==t&&null!==(a=t.attributes)&&void 0!==a&&a.basePrice?{size:t.attributes.size,basePrice:{...t.attributes.basePrice,quantity:1}}:{};null!==l&&void 0!==l&&l.key&&n(l.key,{decalScale:Number(e),...s})},onRotate:e=>{(0,r.startTransition)((()=>{null!==l&&void 0!==l&&l.key&&n(l.key,{decalRotation:Number(e)})}))},prices:null===s||void 0===s?void 0:s.prices}),(0,x.jsx)(ae,{editGraphic:l,graphic:null===l||void 0===l?void 0:l.graphic}),(0,x.jsx)(A,{disabled:!l,onApply:()=>{null!==l&&void 0!==l&&l.key&&n(l.key,{decalFreeze:!1,edit:!1}),t(!1)}})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:$.customiserFlags,children:[(0,x.jsx)("h3",{children:"Your Images"}),null===i||void 0===i?void 0:i.map((e=>(0,x.jsx)(ee,{graphic:e,setShowSelector:t},e.key))),(0,x.jsx)(M.Z,{colour:"red",onClick:()=>{t(!0)},children:"Add Image"})]}),(0,x.jsx)(C,{})]})})},le={root:"MaterialGroup_root__M5bHl",colourGroups:"MaterialGroup_colourGroups__G3KSo",materialType:"MaterialGroup_materialType__X63YP",materialType__title:"MaterialGroup_materialType__title__nQjVb",materials:"MaterialGroup_materials__iAoDB",selected:"MaterialGroup_selected__YMvLv",popup:"MaterialGroup_popup__4J8xn"};var se=i(5847),oe=i(9276),re=i(2546),de=i(1085),ce=i(763);const ue=e=>(0,ce.uniqBy)(e,"id"),ve={colourGroups:[],materialTypes:[],materials:[]},he=(e,t)=>({...ve,filteredMaterials:()=>{const e=t().materials,i=t().selectedColourGroup;return e.filter((e=>{var t,a;return null===(t=e.attributes)||void 0===t||null===(a=t.colourGroups)||void 0===a?void 0:a.data.find((e=>e.id===(null===i||void 0===i?void 0:i.id)))}))},resetMaterialGroup:()=>e(ve),setMaterials:(t,i,a)=>{e((0,re.ZP)((e=>{const n=t.flatMap((e=>{var t,i;return null===(t=e.attributes)||void 0===t||null===(i=t.colourGroups)||void 0===i?void 0:i.data}));var l;e.colourGroups=(l=n,(0,ce.uniqBy)(l,"id")),e.selectedColourGroup=a||e.colourGroups[0];const s=t.filter((t=>{var i,a;return null===(i=t.attributes)||void 0===i||null===(a=i.colourGroups)||void 0===a?void 0:a.data.find((t=>{var i;return t.id===(null===(i=e.selectedColourGroup)||void 0===i?void 0:i.id)}))})).map((e=>{var t,i;return null===(t=e.attributes)||void 0===t||null===(i=t.type)||void 0===i?void 0:i.data}));e.materialTypes=ue(s),e.selectedMaterialType=i||e.materialTypes[0],e.materials=(e=>(0,ce.uniqBy)(e,"id"))(t)})))},setColourGroup:t=>{e((0,re.ZP)((e=>{e.selectedColourGroup=t;const i=e.materials.filter((t=>{var i,a;return null===(i=t.attributes)||void 0===i||null===(a=i.colourGroups)||void 0===a?void 0:a.data.find((t=>{var i;return t.id===(null===(i=e.selectedColourGroup)||void 0===i?void 0:i.id)}))})).map((e=>{var t,i;return null===(t=e.attributes)||void 0===t||null===(i=t.type)||void 0===i?void 0:i.data}));e.materialTypes=ue(i)})))},setMaterialType:t=>{e((0,re.ZP)((e=>{e.selectedMaterialType=t})))}}),{Provider:me,useStore:pe}=(0,oe.Z)(),xe=()=>(0,se.Ue)()((0,de.mW)(he)),ge=e=>{(e=>"touches"in e)(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()},fe=e=>{var t,i,a,n,s,o,u,v,h;let{className:m,material:p,onMaterialSelected:g,selectedMaterialId:f}=e;const _=l()(le.material,m,{[le.selected]:p.id===f}),C=d("popupContainer"),[y,j]=(0,r.useState)(!1),N=null===p||void 0===p||null===(t=p.attributes)||void 0===t||null===(i=t.images)||void 0===i?void 0:i.find((e=>"map"===(null===e||void 0===e?void 0:e.mapType))),b=function(e,t){let{shouldPreventDefault:i=!0,delay:a=300}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[n,l]=(0,r.useState)(!1),s=(0,r.useRef)(null),o=(0,r.useRef)(null),d=(0,r.useCallback)((t=>{i&&t.target&&(t.target.addEventListener("touchend",ge,{passive:!1}),o.current=t.target),s.current=setTimeout((()=>{e(t),l(!0)}),a)}),[e,a,i]),c=(0,r.useCallback)((function(e){let a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];s.current&&clearTimeout(s.current),a&&!n&&t&&t(),l(!1),i&&o.current&&o.current.removeEventListener("touchend",ge)}),[i,t,n]);return{onMouseDown:e=>d(e),onTouchStart:e=>d(e),onMouseUp:e=>c(e),onMouseLeave:e=>c(e,!1),onTouchEnd:e=>c(e)}}((()=>{j(!0)}),(()=>{console.log("mapImage",N),p&&g(p)}),{delay:1e3});return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("button",{className:_,...b,"data-name":null===(a=p.attributes)||void 0===a?void 0:a.name,children:N&&(0,x.jsx)("img",{src:null===N||void 0===N||null===(n=N.image)||void 0===n||null===(s=n.data)||void 0===s||null===(o=s.attributes)||void 0===o?void 0:o.formats.thumbnail.url})}),y&&C&&(0,c.createPortal)((0,x.jsx)("div",{className:le.popup,onClick:()=>{j(!1)},children:(0,x.jsx)("img",{height:"300",width:"300",src:null===N||void 0===N||null===(u=N.image)||void 0===u||null===(v=u.data)||void 0===v||null===(h=v.attributes)||void 0===h?void 0:h.formats.large.url,alt:""})}),C)]})},_e=e=>{let{className:t,onMaterialSelected:i,hideColorGroups:a,selectedMaterialId:n}=e;const s=l()(le.materialType,t),{materialTypes:o,filteredMaterials:r,materials:d}=pe(),c=a?d:r();return(0,x.jsxs)("div",{className:s,children:[!a&&(0,x.jsx)("h5",{children:"Texture"}),o.map((e=>{var t;return(0,x.jsxs)("div",{className:le.materialType,children:[(0,x.jsx)("h6",{className:le.materialType__title,children:null===(t=e.attributes)||void 0===t?void 0:t.name}),(0,x.jsx)("div",{className:le.materials,children:c.filter((t=>{var i,a,n;return(null===(i=t.attributes)||void 0===i||null===(a=i.type)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.id)===e.id})).map((e=>(0,x.jsx)(fe,{material:e,onMaterialSelected:i,selectedMaterialId:n},e.id)))})]},e.id)}))]})},Ce="SelectedMaterialInfo_root__kIp+x",ye="SelectedMaterialInfo_root__noMaterial__dtWKf",je="SelectedMaterialInfo_currencyContainer__s15RH",Ne="SelectedMaterialInfo_materialName__vha4F",be=()=>{var e,t,i,n,s;const o=d("CustomiserNavMaterial"),{selectedPart:u,parts:v}=(0,a.b)(),h=(0,r.useMemo)((()=>{var e;return null===(e=v.find((e=>e.part.id===(null===u||void 0===u?void 0:u.id))))||void 0===e?void 0:e.material}),[u,v]);return o?h?c.createPortal((0,x.jsxs)("div",{className:Ce,children:[(0,x.jsxs)("span",{children:[(0,x.jsx)("div",{className:Ne,children:null===(e=h.attributes)||void 0===e?void 0:e.name}),(0,x.jsx)("small",{children:(0,x.jsx)("i",{children:"TODO: Add currency"})})]}),(0,x.jsxs)("div",{className:je,children:["$",null===(t=h.attributes)||void 0===t||null===(i=t.price)||void 0===i||null===(n=i.data)||void 0===n||null===(s=n.attributes)||void 0===s?void 0:s.price]})]}),o):c.createPortal((0,x.jsx)("div",{className:l()(Ce,ye),children:"No material selected."}),o):null},Te=e=>{var t;let{className:i,materialGroup:a,materialType:n,colourGroup:s,onMaterialSelected:o,hideColorGroups:d,selectedMaterialId:c}=e;const u=pe((e=>e.colourGroups)),v=pe((e=>e.selectedColourGroup)),h=pe((e=>e.setMaterials)),m=pe((e=>e.setColourGroup)),p=l()(le.root,i),g=null!==a&&void 0!==a&&null!==(t=a.attributes)&&void 0!==t&&t.materialTypes?a.attributes.materialTypes.data.map((e=>e.id)):[],{data:f}=(0,W.hF)(q.SL,{filters:{type:{id:{in:g}}},pagination:{pageSize:200}},{select:e=>{var t;return null===(t=e.materials)||void 0===t?void 0:t.data}});return(0,r.useEffect)((()=>{null!==f&&void 0!==f&&f.length&&h(f,n,s)}),[f]),a?(0,x.jsxs)("div",{className:p,children:[!d&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("h5",{children:"Colour"}),(0,x.jsx)("div",{className:le.colourGroups,children:u.map((e=>{var t,i;const a={background:null!==(t=null===(i=e.attributes)||void 0===i?void 0:i.colour)&&void 0!==t?t:"#000"};var n;(null===v||void 0===v?void 0:v.id)===e.id&&(a.outline="4px solid ".concat(null===(n=e.attributes)||void 0===n?void 0:n.colour));return(0,x.jsx)("button",{onClick:()=>m(e),children:(0,x.jsx)("svg",{style:a,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 42 42",fill:"transparent",children:(0,x.jsx)("rect",{width:"100%",height:"100%"})})},e.id)}))})]}),(0,x.jsx)(_e,{hideColorGroups:d,onMaterialSelected:o,selectedMaterialId:c}),(0,x.jsx)(be,{})]}):null},ke=e=>(0,x.jsx)(me,{createStore:xe,children:(0,x.jsx)(Te,{...e})});var Se=i(2306),we=i(1153);const Pe={buttonContainer:"NavPart_buttonContainer__3whqC",showOptional:"NavPart_showOptional__s6PPL"},Ie=e=>{let{onClick:t,children:i,isOn:a,className:n}=e;console.log("isOn",a);const l="\n    ".concat(f.Z.togglePillButton,"\n    ").concat(n,"\n    ").concat(a?f.Z.on:"","\n  ");return(0,x.jsx)("button",{className:l,onClick:t,children:i})},Me=e=>{var t,i,n,o,d,c;let{className:u,part:v}=e;const h=l()(Pe.root,u),m=(0,a.b)((e=>e.selectedPart)),p=(0,a.b)((e=>e.setPart)),g=(0,a.b)((e=>e.removePart)),f=(0,a.b)((e=>e.parts)),_=(0,r.useMemo)((()=>f.find((e=>e.part.id===(null===v||void 0===v?void 0:v.id)))),[v]),[y,j]=(0,r.useState)(!1);let N=null===(t=f.find((e=>e.part.name===(null===m||void 0===m?void 0:m.name))))||void 0===t?void 0:t.material.id;const b=N?null:"Are you sure you want to continue with the default color?";if(null===v||void 0===v||null===(i=v.materialGroup)||void 0===i||!i.data)return null;return(0,r.useEffect)((()=>{v.optional&&!y&&_&&j(!0)}),[]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(s.E.div,{className:h,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,x.jsx)("div",{className:Pe.buttonContainer,children:v.optional&&(0,x.jsxs)(Ie,{className:Pe.showOptional,isOn:y,onClick:()=>{return j(e=!y),void(e||g(v));var e},children:[y?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(we.iFH,{}),"\u2002Remove"]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(Se.D0w,{}),"\u2002Add"]})," ",v.name]})}),(!v.optional||v.optional&&y)&&(0,x.jsx)(r.Suspense,{fallback:(0,x.jsx)("div",{children:"Loading..."}),children:(0,x.jsx)(ke,{materialGroup:v.materialGroup.data,materialType:null===_||void 0===_||null===(n=_.material.attributes)||void 0===n||null===(o=n.type)||void 0===o?void 0:o.data,colourGroup:null===_||void 0===_||null===(d=_.material.attributes)||void 0===d||null===(c=d.colourGroups)||void 0===c?void 0:c.data[0],onMaterialSelected:e=>{m&&e&&(N=e.id,p(m,e))},selectedMaterialId:N})})]},v.id),(0,x.jsx)(C,{confirmStorage:"partsMaterial",confirmText:b})]})},Fe="FormInput_root__cf10F",Oe="FormInput_input__gRXur",Be="FormInput_label__9L2lb",ze=e=>{let{className:t,placeholder:i,children:a,...n}=e;const s=l()(Fe,t);return(0,x.jsxs)("div",{className:s,children:[(0,x.jsx)("input",{className:Oe,...n,placeholder:" "}),(0,x.jsx)("label",{className:Be,children:i}),a]})},Ge="FormSelect_root__li+Rt",Ee="FormSelect_select__ftYcv",He="FormSelect_icon__juFw+",Le=e=>{let{className:t,children:i,...a}=e;const n=l()(Ge,t);return(0,x.jsxs)("div",{className:n,children:[(0,x.jsx)("select",{className:Ee,...a,children:i}),(0,x.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:He,viewBox:"0 0 18.108 30.546",children:(0,x.jsx)("path",{d:"m2.835 30.545-2.836-2.836 12.387-12.436L0 2.835 2.836-.001l15.272 15.274Z"})})]})},Ae=(e,t,i)=>{let a="";if("KGS"===e)switch(!0){case 0<=t&&t<10:a="BABY";break;case 10<=t&&t<16:a="TODDLER";break;case 16<=t&&t<22:a="S-CHILD";break;case 22<=t&&t<30:a="M-CHILD";break;case 30<=t&&t<40:a="L-CHILD";break;case 40<=t&&t<50:a="YOUTH";break;case 50<=t&&t<59:a="XS";break;case 59<=t&&t<69:a="S";break;case 69<=t&&t<79:a="M";break;case 79<=t&&t<90:a="L";break;case 90<=t&&t<101:a="XL";break;case 101<=t&&t<111:a="2XL";break;case 111<=t&&t<120:a="3XL";break;case 120<=t:a="4XL"}else switch(!0){case 0<=t&&t<22:a="BABY";break;case 22<=t&&t<35.3:a="TODDLER";break;case 35.3<=t&&t<48.5:a="S-CHILD";break;case 48.5<=t&&t<66.1:a="M-CHILD";break;case 66.1<=t&&t<88.2:a="L-CHILD";break;case 88.2<=t&&t<110.2:a="YOUTH";break;case 110.2<=t&&t<130:a="XS";break;case 130<=t&&t<152.1:a="S";break;case 152.1<=t&&t<174.2:a="M";break;case 174.2<=t&&t<198.4:a="L";break;case 198.4<=t&&t<222.7:a="XL";break;case 222.7<=t&&t<244.7:a="2XL";break;case 244.7<=t&&t<264.6:a="3XL";break;case 264.6<=t:a="4XL"}return i.find((e=>{var t;return null===(t=e.sku)||void 0===t?void 0:t.endsWith(a)}))};var Ve=i(9135);const Ze={variations:"NavSize_variations__cMdjc",unitToggle:"NavSize_unitToggle__LqIuI",toggleButton:"NavSize_toggleButton__5PZDI",toggleButtonSelected:"NavSize_toggleButtonSelected__au+Rx"},De=e=>{let{className:t}=e;const i=l()(Ze.root,t),n=(0,a.b)((e=>e.variations)),o=(0,a.b)((e=>e.setSizing)),d=(0,a.b)((e=>{var t;return null===(t=e.sizing)||void 0===t?void 0:t.weight})),c=(0,a.b)((e=>{var t;return null===(t=e.sizing)||void 0===t?void 0:t.height})),u=(0,a.b)((e=>{var t;return null===(t=e.sizing)||void 0===t?void 0:t.variation}));(0,r.useEffect)((()=>{if(null!==d&&void 0!==d&&d.value&&d.unit){const e=Ae(d.unit,d.value,n);o(void 0,void 0,e)}}),[d,n]);const v=e=>{o({value:null===c||void 0===c?void 0:c.value,unit:e})},h=e=>{o(void 0,{value:null===d||void 0===d?void 0:d.value,unit:e})};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(s.E.div,{className:i,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[(0,x.jsx)("h3",{children:"Size Details"}),(0,x.jsx)("p",{children:"To help us make sure the size you\u2019ve selected is correct, enter your height and weight below."}),(0,x.jsx)(ze,{type:"number",placeholder:"Enter Height",step:"0.1",required:!0,value:null!==c&&void 0!==c&&c.value?c.value:"",onChange:e=>{o({value:Number(e.target.value),unit:"CM"})},children:(0,x.jsxs)("div",{className:Ze.unitToggle,children:[(0,x.jsx)("button",{className:l()(Ze.toggleButton,{[Ze.toggleButtonSelected]:(null===c||void 0===c?void 0:c.unit)===Ve.iI.HEIGHT.CM}),onClick:()=>v(Ve.iI.HEIGHT.CM),children:Ve.iI.HEIGHT.CM}),"/",(0,x.jsx)("button",{className:l()(Ze.toggleButton,{[Ze.toggleButtonSelected]:(null===c||void 0===c?void 0:c.unit)===Ve.iI.HEIGHT.INCH}),onClick:()=>v(Ve.iI.HEIGHT.INCH),children:Ve.iI.HEIGHT.INCH})]})}),(0,x.jsx)(ze,{type:"number",placeholder:"Enter Weight",step:"0.1",required:!0,value:null!==d&&void 0!==d&&d.value?d.value:"",onChange:e=>{o(void 0,{value:Number(e.target.value),unit:"KGS"})},children:(0,x.jsxs)("div",{className:Ze.unitToggle,children:[(0,x.jsx)("button",{className:l()(Ze.toggleButton,{[Ze.toggleButtonSelected]:(null===d||void 0===d?void 0:d.unit)===Ve.iI.WEIGHT.KG}),onClick:()=>h(Ve.iI.WEIGHT.KG),children:Ve.iI.WEIGHT.KG}),"/",(0,x.jsx)("button",{className:l()(Ze.toggleButton,{[Ze.toggleButtonSelected]:(null===d||void 0===d?void 0:d.unit)===Ve.iI.WEIGHT.LB}),onClick:()=>h(Ve.iI.WEIGHT.LB),children:Ve.iI.WEIGHT.LB})]})}),(0,x.jsx)("h3",{children:"Suggested Size"}),(0,x.jsx)(Le,{value:null===u||void 0===u?void 0:u.id,onChange:e=>{const t=e.target.value,i=n.find((e=>e.id===t));o(void 0,void 0,i)},children:n.map((e=>(0,x.jsx)("option",{value:e.id,children:e.title},e.id)))})]}),(0,x.jsx)(C,{})]})},Re={arial:"NavText_arial__de7L4",oswald:"NavText_oswald__siLdE",college:"NavText_college__YR6iT",ballantines:"NavText_ballantines__1B1LU",navTextEdit:"NavText_navTextEdit__8WUIS",textItem:"NavText_textItem__nQrv4",textItemText:"NavText_textItemText__op7hZ",finishSelections:"NavText_finishSelections__fH4yd",disabled:"NavText_disabled__M-nHo",showOutline:"NavText_showOutline__T7KEv",fontSelection:"NavText_fontSelection__AH-QM",font:"NavText_font__v43yE",finishSelection:"NavText_finishSelection__CfQ+O",selected:"NavText_selected__SIXSo",pricing:"NavText_pricing__qUsci",materialGroup:"NavText_materialGroup__j+DTa",navTextsSelection:"NavText_navTextsSelection__gJNy+",title:"NavText_title__u+YKh",titleText:"NavText_titleText__lFoUP",textPreview:"NavText_textPreview__CfhSo",noText:"NavText_noText__Parmv",textPreview__imgContainer:"NavText_textPreview__imgContainer__6SJ9b",promptMessage:"NavText_promptMessage__iKeIZ",applyTextBtnContainer:"NavText_applyTextBtnContainer__I8nfd",navHeaderSaveText:"NavText_navHeaderSaveText__h8PoA",selectedCategoryItem:"NavText_selectedCategoryItem__jjmwJ",finishedCategoryItem:"NavText_finishedCategoryItem__AC3wU",categoryDisplayName:"NavText_categoryDisplayName__pATtN",textInputContainer:"NavText_textInputContainer__KQMDX",textInput:"NavText_textInput__Z49KW",textDone:"NavText_textDone__rPeDE",textPreviewTextInput:"NavText_textPreviewTextInput__lQXU8"},We={},qe=e=>{let{className:t,price:i,priceString:a}=e;const n=l()("price-item",We.root,t),s=void 0!==i?"".concat("\xa3").concat(i.toFixed(2)):"".concat("\xa3").concat(a);return s?(0,x.jsx)("span",{className:n,children:s}):null},Xe=e=>{var t,i,n,s,o,d,c,u,v,h,m,p,g;let{editText:f={},setIsPickingCrystal:_}=e;const{selectedName:C}=f,y=null===f||void 0===f||null===(t=f.crystalBackground)||void 0===t?void 0:t.id,[j,N]=(0,r.useState)(!(null===f||void 0===f||!f.crystalPrice)),[b,T]=(0,r.useState)(!(null===f||void 0===f||!f.puffPrice)),k=(0,r.useMemo)((()=>(null===C||void 0===C?void 0:C.id)===Ve.gQ),[C]),{updateText:S}=(0,a.b)();if((0,r.useEffect)((()=>{T(!!f.puffPrice)}),[f.puffPrice]),!C)return null;const w=e=>{var t,i,a,n;null!==f&&void 0!==f&&f.key&&(N(e),S(f.key,e?{crystalPrice:{price:null===(t=C.attributes)||void 0===t||null===(i=t.crystalPrice)||void 0===i?void 0:i.price,quantity:1,shopifyVariantId:null===(a=C.attributes)||void 0===a||null===(n=a.crystalPrice)||void 0===n?void 0:n.shopifyVariantId}}:{crystalPrice:void 0,crystalBackground:void 0}))},P=e=>{var t,i,a,n;null!==f&&void 0!==f&&f.key&&(T(e),S(f.key,e?{puffPrice:{price:null===(t=C.attributes)||void 0===t||null===(i=t.puffPrice)||void 0===i?void 0:i.price,quantity:1,shopifyVariantId:null===(a=C.attributes)||void 0===a||null===(n=a.puffPrice)||void 0===n?void 0:n.shopifyVariantId}}:{puffPrice:void 0}))};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:Re.finishSelections,children:[(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:!j}),onClick:()=>{_&&_(!1),w(!1)},children:["No Crystals",(0,x.jsxs)("div",{className:Re.pricing,children:[" +",(0,x.jsx)(qe,{price:0})]})]}),(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:j}),onClick:()=>{w(!0),_&&_(!0)},children:["Add Crystals",(0,x.jsxs)("div",{className:Re.pricing,children:[" +",(0,x.jsx)(qe,{price:null===(i=C.attributes)||void 0===i||null===(n=i.crystalPrice)||void 0===n?void 0:n.price})]})]})]}),!j&&(0,x.jsxs)("div",{className:Re.finishSelections,children:[(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:!b}),onClick:()=>P(!1),children:["Flat",(0,x.jsxs)("div",{className:Re.pricing,children:[" +",(0,x.jsx)(qe,{price:0})]})]}),(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:b,[Re.disabled]:!k}),onClick:()=>P(!0),children:["Add 3D Puff",k?(0,x.jsxs)("div",{className:Re.pricing,children:[" +",(0,x.jsx)(qe,{price:null===(s=C.attributes)||void 0===s||null===(o=s.puffPrice)||void 0===o?void 0:o.price})]}):(0,x.jsx)("div",{className:Re.pricing,children:"(Only available for luxury colors)"})]})]}),j&&(0,x.jsx)(ke,{hideColorGroups:!0,materialGroup:null===(d=C.attributes)||void 0===d||null===(c=d.materialGroup)||void 0===c?void 0:c.data,materialType:null===(u=f.material)||void 0===u||null===(v=u.attributes)||void 0===v||null===(h=v.type)||void 0===h?void 0:h.data,colourGroup:null===(m=f.material)||void 0===m||null===(p=m.attributes)||void 0===p||null===(g=p.colourGroups)||void 0===g?void 0:g.data[0],onMaterialSelected:e=>{null!==f&&void 0!==f&&f.key&&(console.log("crystalBackground",e),S(f.key,{crystalBackground:e}))},className:Re.materialGroup,selectedMaterialId:y})]})},Ue=e=>{var t,i,n,s,o,d,c,u,v;let{editText:h={}}=e;const m=(0,a.b)((e=>e.updateText)),p=null===h||void 0===h||null===(t=h.material)||void 0===t?void 0:t.id,{selectedName:g}=h,f=(0,r.useRef)(g),{data:_}=(0,W.GE)(q.SL,{},{select:e=>{var t;return null===(t=e.names)||void 0===t?void 0:t.data}});(0,r.useEffect)((()=>{var e,t,i,a,n,l,s,o,r,d,c,u,v;null!==h&&void 0!==h&&h.key&&g&&f.current!==g&&(f.current=g,m(h.key,{basePrice:{price:null===(e=g.attributes)||void 0===e||null===(t=e.basePrice)||void 0===t?void 0:t.price,quantity:1,shopifyVariantId:null===(i=g.attributes)||void 0===i||null===(a=i.basePrice)||void 0===a?void 0:a.shopifyVariantId},letterPrice:{price:null===(n=g.attributes)||void 0===n||null===(l=n.letterPrice)||void 0===l?void 0:l.price,quantity:1,shopifyVariantId:null===(s=g.attributes)||void 0===s||null===(o=s.letterPrice)||void 0===o?void 0:o.shopifyVariantId},nameType:{id:g.id,name:null===(r=g.attributes)||void 0===r?void 0:r.name},material:void 0,...h.outline?{outlinePrice:{price:null===(d=g.attributes)||void 0===d||null===(c=d.outlinePrice)||void 0===c?void 0:c.price,quantity:1,shopifyVariantId:null===(u=g.attributes)||void 0===u||null===(v=u.outlinePrice)||void 0===v?void 0:v.shopifyVariantId}}:{},puffPrice:void 0}))}),[g]);return(0,x.jsxs)(x.Fragment,{children:[!g&&(0,x.jsx)("i",{className:Re.promptMessage,children:"Select a text color type"}),(0,x.jsx)("div",{className:Re.categoryDisplayName,children:"Choose Color:"}),(0,x.jsx)("div",{className:Re.finishSelections,children:null===_||void 0===_?void 0:_.map((e=>{var t,i,a,n,s;return(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:g&&e.id===g.id}),onClick:()=>{return t=e,void(null!==h&&void 0!==h&&h.key&&m(h.key,{selectedName:t}));var t},children:[null===(t=e.attributes)||void 0===t?void 0:t.name,(0,x.jsxs)("div",{className:Re.pricing,children:[(0,x.jsx)(qe,{price:null===(i=e.attributes)||void 0===i||null===(a=i.basePrice)||void 0===a?void 0:a.price})," + ",(0,x.jsx)(qe,{price:null===(n=e.attributes)||void 0===n||null===(s=n.letterPrice)||void 0===s?void 0:s.price})," per letter"]})]},e.id)}))}),g&&(0,x.jsx)(ke,{hideColorGroups:!0,materialGroup:null===g||void 0===g||null===(i=g.attributes)||void 0===i||null===(n=i.materialGroup)||void 0===n?void 0:n.data,materialType:null===h||void 0===h||null===(s=h.material)||void 0===s||null===(o=s.attributes)||void 0===o||null===(d=o.type)||void 0===d?void 0:d.data,colourGroup:null===h||void 0===h||null===(c=h.material)||void 0===c||null===(u=c.attributes)||void 0===u||null===(v=u.colourGroups)||void 0===v?void 0:v.data[0],onMaterialSelected:e=>{null!==h&&void 0!==h&&h.key&&m(h.key,{material:e})},className:Re.materialGroup,selectedMaterialId:p})]})},Ye=e=>{var t,i,n,s,o,d,c,u,v,h,m;let{editText:p={},setIsPickingOutline:g}=e;const[f,_]=(0,r.useState)(!(null===p||void 0===p||!p.outline)),C=null===p||void 0===p||null===(t=p.outline)||void 0===t?void 0:t.id,{updateText:y}=(0,a.b)(),{selectedName:j}=p;if(!j)return null;const N=e=>{_(e),!e&&null!==p&&void 0!==p&&p.key&&y(p.key,{outline:void 0,outlinePrice:void 0})};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:l()(Re.showOutline,Re.finishSelections),children:[(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:!f}),onClick:()=>{N(!1),g&&g(!1)},children:["No Outline",(0,x.jsxs)("div",{className:Re.pricing,children:[" +",(0,x.jsx)(qe,{price:0})]})]}),(0,x.jsxs)("div",{className:l()(Re.finishSelection,{[Re.selected]:f}),onClick:()=>{N(!0),g&&g(!0)},children:["Add Outline",(0,x.jsxs)("div",{className:Re.pricing,children:[" +",(0,x.jsx)(qe,{price:null===(i=j.attributes)||void 0===i||null===(n=i.outlinePrice)||void 0===n?void 0:n.price})]})]})]}),f&&(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(ke,{hideColorGroups:!0,materialGroup:null===j||void 0===j||null===(s=j.attributes)||void 0===s||null===(o=s.outlineGroup)||void 0===o?void 0:o.data,materialType:null===p||void 0===p||null===(d=p.outline)||void 0===d||null===(c=d.attributes)||void 0===c||null===(u=c.type)||void 0===u?void 0:u.data,colourGroup:null===p||void 0===p||null===(v=p.outline)||void 0===v||null===(h=v.attributes)||void 0===h||null===(m=h.colourGroups)||void 0===m?void 0:m.data[0],onMaterialSelected:e=>{var t,i,a,n;null!==p&&void 0!==p&&p.key&&y(p.key,{outline:e,outlinePrice:{price:null===(t=j.attributes)||void 0===t||null===(i=t.outlinePrice)||void 0===i?void 0:i.price,quantity:1,shopifyVariantId:null===(a=j.attributes)||void 0===a||null===(n=a.outlinePrice)||void 0===n?void 0:n.shopifyVariantId}})},className:Re.materialGroup,selectedMaterialId:C})})]})},Ke=[{name:"Arial",className:Re.arial,url:"https://boxxer-api-dev.nyc3.cdn.digitaloceanspaces.com/fonts/arial-bold-webfont.woff"},{name:"Oswald",className:Re.oswald,url:"https://boxxer-api-dev.nyc3.cdn.digitaloceanspaces.com/fonts/oswald-semibold.woff"},{name:"College",className:Re.college,url:"https://boxxer-api-dev.nyc3.cdn.digitaloceanspaces.com/fonts/college_block-webfont.woff"},{name:"Ballantines",className:Re.ballantines,url:"https://boxxer-api-dev.nyc3.cdn.digitaloceanspaces.com/fonts/ballantines-bold-webfont.woff"}],Qe=e=>{var t;let{className:i,editText:n}=e;const s=d("popupContainer"),[o,c]=(0,r.useState)(null===n||void 0===n?void 0:n.text),[u,v]=(0,r.useState)(null!==(t=Ke.find((e=>(null===n||void 0===n?void 0:n.font)===e.url)))&&void 0!==t?t:Ke[0]),{addText:h,updateText:m}=(0,a.b)((e=>e));(0,r.useEffect)((()=>{null!==n&&void 0!==n&&n.key?m(n.key,{text:o,font:u.url,edit:!0}):o&&h({text:o,font:u.url})}),[o,u]);return s?(0,x.jsxs)("div",{className:i,children:[(0,x.jsx)("div",{className:Re.categoryDisplayName,children:"Choose Font:"}),(0,x.jsx)("div",{className:Re.fontSelection,children:Ke.map((e=>(0,x.jsx)("div",{onClick:()=>(e=>{v(e)})(e),className:l()(Re.font,e.className,{[Re.selected]:u.name===e.name}),children:e.name},e.name)))})]}):null},Je=e=>{let{className:t,text:i,setShowSelector:n}=e;const{updateText:s,deleteText:o}=(0,a.b)((e=>e)),r=(l()(Re.root,t),()=>{i.key&&(s(i.key,{edit:!0}),n&&n(!0))});return(0,x.jsxs)("div",{className:Re.textItem,onClick:r,children:[(0,x.jsx)("div",{className:Re.textItemText,children:i.text}),(0,x.jsx)(D,{toggleVisibility:()=>{i.key&&s(i.key,{isVisible:"undefined"!==typeof i.isVisible&&!i.isVisible})},onEdit:r,onDelete:()=>{i.key&&o(i.key)},isVisible:i.isVisible})]})},$e=e=>{let{onAddTextClicked:t,onTextSelected:i}=e;const n=(0,a.b)((e=>e.texts));return(0,x.jsxs)("div",{className:Re.navTextsSelection,children:[(0,x.jsxs)("div",{className:Re.title,children:[(0,x.jsx)("h3",{className:Re.titleText,children:"Your Texts"}),(0,x.jsx)(_,{onClick:t,children:"Add Text"})]}),n.map((e=>(0,x.jsx)(Je,{text:e,setShowSelector:i},e.key))),(0,x.jsx)(C,{confirmStorage:"saveTextsNotification",confirmText:"You can still add more text. Save anyway?"})]})};function et(e){var t,i,a,n,l;return null===e||void 0===e||null===(t=e.attributes)||void 0===t||null===(i=t.images)||void 0===i||null===(a=i.find((e=>"map"===(null===e||void 0===e?void 0:e.mapType))))||void 0===a||null===(n=a.image.data)||void 0===n||null===(l=n.attributes)||void 0===l?void 0:l.formats.large.url}const tt=i(1627).H.instance();async function it(e){let{img:t,hasPuff:i,blur:a}=e;const n=i?a||7:1;return tt.generateFromImage(t,{strength:.5,blur:n,level:1})}class at{constructor(e){let{hasPuff:t,toNormalMap:i,text:a,patternType:n}=e;this.canvas=void 0,this.ctx=void 0,this.outlineCanvas=void 0,this.outlineCtx=void 0,this.normalMapTextureCanvas=void 0,this.normalMapTextureCtx=void 0,this.normalMapCanvas=void 0,this.normalMapCtx=void 0,this.normalMapOutlineTextureCanvas=void 0,this.normalMapOutlineTextureCtx=void 0,this.normalMapOutlineCanvas=void 0,this.normalMapOutlineCtx2=void 0,this.crystalBgPatternCanvas=void 0,this.crystalBgPatternCtx=void 0,this.hasPuff=void 0,this.toNormalMap=void 0,this.patternType=void 0,this.text=void 0,this.canvasHeight=void 0,this.canvasWidth=void 0,this.fontSize=void 0,this.outlineWidth=void 0,this.hasPuff=t,this.toNormalMap=i,this.patternType=n,this.text=a,this.fontSize=360,this.canvasHeight=400,this.canvasWidth=3200,this.outlineWidth=20,this.canvas=document.createElement("canvas"),this.canvas.height=this.canvasHeight,this.canvas.width=this.canvasWidth,this.ctx=this.canvas.getContext("2d"),this.outlineCanvas=document.createElement("canvas"),this.outlineCanvas.height=this.canvasHeight,this.outlineCanvas.width=this.canvasWidth,this.outlineCtx=this.outlineCanvas.getContext("2d"),this.normalMapTextureCanvas=document.createElement("canvas"),this.normalMapTextureCanvas.height=this.canvasHeight,this.normalMapTextureCanvas.width=this.canvasWidth,this.normalMapTextureCtx=this.normalMapTextureCanvas.getContext("2d"),this.normalMapCanvas=document.createElement("canvas"),this.normalMapCanvas.height=this.canvasHeight,this.normalMapCanvas.width=this.canvasWidth,this.normalMapCtx=this.normalMapCanvas.getContext("2d"),this.normalMapOutlineTextureCanvas=document.createElement("canvas"),this.normalMapOutlineTextureCanvas.height=this.canvasHeight,this.normalMapOutlineTextureCanvas.width=this.canvasWidth,this.normalMapOutlineTextureCtx=this.normalMapOutlineTextureCanvas.getContext("2d"),this.normalMapOutlineCanvas=document.createElement("canvas"),this.normalMapOutlineCanvas.height=this.canvasHeight,this.normalMapOutlineCanvas.width=this.canvasWidth,this.normalMapOutlineCtx2=this.normalMapOutlineCanvas.getContext("2d"),this.crystalBgPatternCanvas=document.createElement("canvas"),this.crystalBgPatternCanvas.height=this.canvasHeight,this.crystalBgPatternCanvas.width=this.canvasWidth,this.crystalBgPatternCtx=this.crystalBgPatternCanvas.getContext("2d")}clear(){var e,t;null===(e=this.ctx)||void 0===e||e.clearRect(0,0,this.canvas.width,this.canvas.height),null===(t=this.outlineCtx)||void 0===t||t.clearRect(0,0,this.canvas.width,this.canvas.height)}async drawImg(e,t){e.drawImage(t,0,0,this.canvas.width,this.canvas.height)}showTestCanvas(e){document.getElementById("testPreview").innerHTML=""}async maskImage(e,t){e.globalCompositeOperation="source-in",await this.drawImg(e,t),e.globalCompositeOperation="source-over"}drawPreviewText(e){this.text&&(e.font="".concat(this.fontSize,"px testFont"),e.textAlign="center",e.fillText(this.text,this.canvas.width/2,this.canvas.height/2+15+this.fontSize/4))}drawPreviewOutlineText(){this.text&&(this.outlineCtx.font="".concat(this.fontSize,"px testFont"),this.outlineCtx.textAlign="center",this.outlineCtx.lineWidth=this.outlineWidth,this.outlineCtx.strokeText(this.text,this.canvas.width/2,this.canvas.height/2+15+this.fontSize/4))}drawPreviewOutlineOnlyText(e){this.text&&(e.font="".concat(this.fontSize,"px testFont"),e.textAlign="center",e.lineWidth=30,e.fillStyle="green",e.strokeText(this.text,this.canvas.width/2,this.canvas.height/2+15+this.fontSize/4),e.globalCompositeOperation="destination-out",e.fillText(this.text,this.canvas.width/2,this.canvas.height/2+15+this.fontSize/4),e.globalCompositeOperation="source-over")}async drawNormalMap(e){if(this.drawPreviewText(this.normalMapTextureCtx),e){const t=this.normalMapTextureCtx.createPattern(e,"repeat");if(!t)return;this.normalMapTextureCtx.globalCompositeOperation="source-in",this.normalMapTextureCtx.rect(0,0,this.canvasWidth,this.canvasHeight),this.normalMapTextureCtx.fillStyle=t,this.normalMapTextureCtx.fill(),this.normalMapTextureCtx.globalCompositeOperation="source-over"}console.log("toNormalMap",this.toNormalMap);const t=this.toNormalMap?await it({img:this.normalMapTextureCanvas,hasPuff:this.hasPuff}):this.normalMapTextureCanvas;this.normalMapCtx.drawImage(t,0,0)}async drawOutlineNormalMap(e){if(this.drawPreviewOutlineOnlyText(this.normalMapOutlineTextureCtx),e){const t=this.normalMapOutlineTextureCtx.createPattern(e,"repeat");if(!t)return;this.normalMapOutlineTextureCtx.globalCompositeOperation="source-in",this.normalMapOutlineTextureCtx.rect(0,0,this.canvasWidth,this.canvasHeight),"crystals"!==this.patternType&&(this.normalMapOutlineTextureCtx.fillStyle=t),this.normalMapOutlineTextureCtx.fill(),this.normalMapOutlineTextureCtx.globalCompositeOperation="source-over"}const t=this.toNormalMap||"crystals"===this.patternType?await it({img:this.normalMapOutlineTextureCanvas,hasPuff:"crystals"===this.patternType||this.hasPuff,blur:4}):this.normalMapOutlineTextureCanvas;this.normalMapOutlineCtx2.drawImage(t,0,0)}async drawCrystalBg(e,t){const i=this.crystalBgPatternCtx.createPattern(t,"repeat");i&&(this.crystalBgPatternCtx.rect(0,0,this.canvasWidth,this.canvasHeight),this.crystalBgPatternCtx.fillStyle=i,this.crystalBgPatternCtx.fill(),this.crystalBgPatternCtx.globalCompositeOperation="source-in",this.crystalBgPatternCtx.globalAlpha=.9,this.crystalBgPatternCtx.drawImage(this.canvas,0,0,this.canvasWidth,this.canvasHeight),this.crystalBgPatternCtx.drawImage(e,0,0,this.canvasWidth,this.canvasHeight),this.crystalBgPatternCtx.globalCompositeOperation="source-over",this.outlineCtx.drawImage(this.crystalBgPatternCanvas,0,0))}printTextMapToStrokeMap(){this.normalMapCtx.globalCompositeOperation="destination-in",this.normalMapCtx.drawImage(this.normalMapTextureCanvas,0,0),this.normalMapCtx.globalCompositeOperation="source-over",this.normalMapOutlineCtx2.drawImage(this.normalMapCanvas,0,0)}async previewText(e){let{material:t,outline:i,previewImg:a,normalMapPatternImg:n,crystalBgPatternImg:l,crystalBgImg:s}=e;this.text&&(this.clear(),this.showTestCanvas(this.normalMapTextureCanvas),await this.drawNormalMap(n),await this.drawOutlineNormalMap(n),this.printTextMapToStrokeMap(),i&&(this.drawPreviewOutlineText(),await this.maskImage(this.outlineCtx,i)),this.drawPreviewText(this.ctx),t&&await this.maskImage(this.ctx,t),this.outlineCtx.drawImage(this.canvas,0,0),a&&(a.src=this.outlineCanvas.toDataURL()),s&&l&&this.drawCrystalBg(s,l))}mergeCanvas(){this.outlineCtx.drawImage(this.canvas,0,0)}getOutlineCanvas(){return this.outlineCanvas}getNormalMapTextureCanvas(){return this.normalMapTextureCanvas}getNormalMapOutlineCanvas(){return this.normalMapOutlineCanvas}}var nt=i(7760);async function lt(e){return new Promise(((t,i)=>{const a=new Image;e||t(a),a.crossOrigin="anonymous",a.onload=()=>t(a),a.onerror=i,a.src=e}))}var st=i(1435),ot=i(7749),rt=i(4647);const dt="NavTextScene_canvasClickableCover__ZoAVe",ct="NavTextScene_canvasClickableCover__imgContainer__qCzZl",ut="NavTextScene_navTextSceneFullscreen__-hgDQ",vt="NavTextScene_navTextSceneFullscreen__imgContainer__kyglX",ht="NavTextScene_navTextSceneFullscreen__closeBtn__jtMmR",mt="NavTextScene_navTextSceneFullscreen__zoomContainer__struE",pt=e=>{var t,i,a;let{text:n}=e;const l=(0,r.useRef)(null),[s,o]=(0,r.useState)(!1),[u,v]=(0,r.useState)(1),[h,m]=(0,r.useState)(""),p=d("popupContainer"),g=new nt.Vector3(32,4,4),f="2"===(null===(t=n.selectedName)||void 0===t?void 0:t.id),_=!!n.puffPrice,C=!!n.crystalPrice,y=n.normalMap instanceof nt.Texture&&"Luxury"===(null===(i=n.selectedName)||void 0===i||null===(a=i.attributes)||void 0===a?void 0:a.name)?n.normalMap:null;let j=1;if(C?j=4:f&&!_?j=.5:f&&_&&(j=3),!p)return null;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(rt.Xz,{ref:e=>{l.current=e},gl:{preserveDrawingBuffer:!0},children:[(0,x.jsx)(ot.Z,{}),(0,x.jsxs)("mesh",{children:[(0,x.jsx)("planeBufferGeometry",{args:[20,5]}),(0,x.jsx)("meshNormalMaterial",{visible:!1}),(0,x.jsx)(st._,{position:[0,0,0],rotation:[0,0,0],scale:g,children:(0,x.jsx)("meshStandardMaterial",{map:n.preview instanceof nt.Texture?n.preview:null,transparent:!0,roughness:f&&!C?.75:0,depthTest:!0,depthWrite:!1,normalMap:y,normalScale:new nt.Vector2(j,j)})})]})]}),(0,x.jsx)("div",{className:dt,onClick:()=>{var e;o(!0),m((null===(e=l.current)||void 0===e?void 0:e.toDataURL())||"")},children:(0,x.jsx)("span",{className:ct,children:(0,x.jsx)("img",{height:32,width:32,src:"/icons/click-icon.png"})})}),s&&l&&h&&(0,c.createPortal)((0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:ut,children:[(0,x.jsx)("span",{onClick:()=>o(!1),className:ht,children:"x"}),(0,x.jsx)("span",{className:vt,children:(0,x.jsx)("img",{style:{zoom:u},src:h,alt:"Text Preview"})}),(0,x.jsxs)("span",{className:mt,children:[(0,x.jsx)("img",{onClick:function(){v((e=>e>=10?e:e+.1))},height:"32",width:"32",src:"/icons/zoom-in-icon.png",alt:"zoom in"}),(0,x.jsx)("img",{onClick:function(){v((e=>e<=.1?e:e-.1))},height:"32",width:"32",src:"/icons/zoom-out-icon.png",alt:"zoom out"})]})]})}),p)]})};const xt=e=>{var t,i;let{editText:n,mainTextInputRef:l}=e;const s=(0,r.useRef)(null),[o,u]=(0,r.useState)(null===n||void 0===n?void 0:n.font),[v,h]=(0,r.useState)(!1),m=!(null===n||void 0===n||!n.crystalPrice),p="2"===(null===n||void 0===n||null===(t=n.selectedName)||void 0===t?void 0:t.id),g=!(null===n||void 0===n||!n.puffPrice||m),f=!m,_=function(e){let{hasCrystals:t,isLuxury:i}=e;return!t&&i?"embroidery":t?"crystals":""}({hasCrystals:m,isLuxury:p}),{updateText:C,addText:y,isMinimizedCustomiserNav:j}=(0,a.b)(),N=d("NavHeaderAfter"),b=(0,r.useMemo)((()=>lt(et(null===n||void 0===n?void 0:n.material))),[null===n||void 0===n?void 0:n.material]),T=(0,r.useMemo)((()=>lt(et(null===n||void 0===n?void 0:n.outline))),[null===n||void 0===n?void 0:n.outline]),k=(0,r.useMemo)((()=>lt("/Fabric_Knitted_006_height_small.png")),[]),S=(0,r.useMemo)((()=>lt("/crystal-12.png")),[]),w=(0,r.useMemo)((()=>lt(et(null===n||void 0===n?void 0:n.crystalBackground))),[null===n||void 0===n?void 0:n.crystalBackground]),P=(0,r.useMemo)((()=>lt("/crystal-bg-pattern.png")),[]);return(0,r.useEffect)((()=>{const e=s.current;(async()=>{const t=new at({hasPuff:g,toNormalMap:f,patternType:_,text:null===n||void 0===n?void 0:n.text});if(!n||!n.key||!v)return void t.clear();if(!n.text)return t.clear(),void C(n.key,{preview:new nt.CanvasTexture(t.getOutlineCanvas())});o!==(null===n||void 0===n?void 0:n.font)&&(u(null===n||void 0===n?void 0:n.font),await async function(e){const t=new FontFace("testFont","url(".concat(e,")"));await t.load(),document.fonts.add(t)}(null===n||void 0===n?void 0:n.font));const i=(null===n||void 0===n?void 0:n.material)&&await b,a=(null===n||void 0===n?void 0:n.outline)&&await T,l=await k,s=await S,r=await P,d=(null===n||void 0===n?void 0:n.crystalBackground)&&await w,c=p&&!g&&(m?s:l);await t.previewText({material:i,outline:a,previewImg:e,normalMapPatternImg:c,crystalBgPatternImg:r,crystalBgImg:d}),C(n.key,{preview:new nt.CanvasTexture(t.getOutlineCanvas()),normalMap:new nt.CanvasTexture(t.getNormalMapOutlineCanvas())})})()}),[null===n||void 0===n?void 0:n.text,null===n||void 0===n?void 0:n.material,null===n||void 0===n?void 0:n.outline,null===n||void 0===n?void 0:n.font,null===n||void 0===n?void 0:n.crystalBackground,v,null===n||void 0===n?void 0:n.puffPrice,null===n||void 0===n?void 0:n.crystalPrice]),N?(0,c.createPortal)((0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{id:"testPreview",style:{position:"absolute",zIndex:"100"}}),!j&&(null===n||void 0===n?void 0:n.text)&&(0,x.jsx)("div",{className:Re.textPreview,children:(0,x.jsx)("div",{children:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:Re.textPreview__imgContainer,style:{display:"none"},children:(0,x.jsx)("img",{height:80,width:640,ref:e=>{s.current=e,h(!!e)}})}),null!==(i=s.current)&&void 0!==i&&i.src?(0,x.jsx)(x.Fragment,{children:(0,x.jsx)(pt,{text:n})}):""]})})})]}),N):null},gt="NavTextCategories_main__aV8kW",ft=e=>{let{children:t}=e;return(0,x.jsx)("div",{className:gt,children:t})},_t=e=>{let{onClick:t,isClickable:i,isVisible:a}=e;const n="\n    ".concat(f.Z.stepsNavButtons,"\n    ").concat(f.Z.stepsNavButtons__next,"\n    ").concat("undefined"===typeof i||i?f.Z.clickable:"","\n    ").concat("undefined"===typeof a||a?f.Z.visible:"","\n  ");return(0,x.jsxs)("button",{className:n,onClick:t,children:["Next Step \xa0",(0,x.jsx)(G.dhL,{})]})},Ct=e=>{let{onClick:t,isClickable:i,isVisible:a}=e;const n="\n    ".concat(f.Z.stepsNavButtons,"\n    ").concat(f.Z.stepsNavButtons__prev,"\n    ").concat("undefined"===typeof i||i?f.Z.clickable:"","\n    ").concat("undefined"===typeof a||a?f.Z.visible:"","\n  ");return(0,x.jsxs)("button",{className:n,onClick:t,children:[(0,x.jsx)(G.Wuc,{})," \xa0 Previous"]})},yt="NavTextNavSteps_root__Ys0fR",jt=e=>{let{onClick:t,isClickable:i,isVisible:a}=e;const n="\n    ".concat(f.Z.stepsNavButtons,"\n    ").concat(f.Z.stepsNavButtons__cancel,"\n    ").concat("undefined"===typeof i||i?f.Z.clickable:"","\n    ").concat("undefined"===typeof a||a?f.Z.visible:"","\n  ");return(0,x.jsx)("button",{className:n,onClick:t,children:"Cancel"})},Nt=e=>{let{onClick:t,isClickable:i,isVisible:a}=e;const n="\n    ".concat(f.Z.stepsNavButtons,"\n    ").concat(f.Z.stepsNavButtons__next,"\n    ").concat("undefined"===typeof i||i?f.Z.clickable:"","\n    ").concat("undefined"===typeof a||a?f.Z.visible:"","\n  ");return(0,x.jsx)("button",{className:n,onClick:t,children:"Apply Text"})},bt=e=>{let{isClickableNext:t,isClickablePrev:i,isVisibleNext:a,isVisiblePrev:n,onClickNext:l,onClickPrev:s,onClickCancel:o,onClickSave:r}=e;const u=d("CustomiserNavActions"),v=d("popupContainer");return u&&v?(0,x.jsx)(x.Fragment,{children:c.createPortal((0,x.jsxs)("div",{className:yt,children:[!0!==n&&(0,x.jsx)(jt,{onClick:o||(()=>{})}),("undefined"===typeof n||n)&&(0,x.jsx)(Ct,{isClickable:i,isVisible:n,onClick:s||(()=>{})}),("undefined"===typeof a||a)&&(0,x.jsx)(_t,{isClickable:t,isVisible:a,onClick:l||(()=>{})}),!0!==a&&(0,x.jsx)(Nt,{onClick:r||(()=>{})})]}),u)}):null},Tt=(0,r.forwardRef)(((e,t)=>{let{editText:i}=e;const[n,s]=(0,r.useState)(null===i||void 0===i?void 0:i.text),{updateText:o,addText:d}=(0,a.b)((e=>e)),c=l()(Fe,Re.textInput);return(0,r.useEffect)((()=>{null!==i&&void 0!==i&&i.key?o(i.key,{text:n,edit:!0}):n&&d({text:n})}),[n]),(0,r.useEffect)((()=>{console.log("ref",t)}),[t]),(0,x.jsx)("div",{className:Re.textInputContainer,children:(0,x.jsx)("div",{className:c,children:(0,x.jsx)("input",{className:Oe,onChange:e=>{s(e.target.value)},ref:t,placeholder:"Type text here...",value:null===i||void 0===i?void 0:i.text})})})}));Tt.displayName="NavTextInput";const kt=Tt,St=e=>{let{showEditText:t,setShowEditText:i}=e;const[n,l]=(0,r.useState)(0),s=(0,a.b)((e=>e.texts)),o=(0,a.b)((e=>e.updateText)),u=(0,a.b)((e=>e.deleteText)),v=(0,a.b)((e=>e.updateIsMinimizedCustomiserNav)),h=(0,a.b)((e=>e.isMinimizedCustomiserNav)),m=(0,r.useMemo)((()=>null===s||void 0===s?void 0:s.find((e=>e.edit))),[s]),[p,f]=(0,r.useState)(!1),[C,y]=(0,r.useState)(!1),j=d("NavHeader"),N=d("popupContainer"),b=(0,r.useRef)(null),T=2===n&&p&&!(null!==m&&void 0!==m&&m.outline),k=3===n&&C&&!(null!==m&&void 0!==m&&m.crystalBackground),S=3===n&&((null===m||void 0===m?void 0:m.crystalBackground)||!C),w=!(null===m||void 0===m||!m.text),P=!(null===m||void 0===m||!m.material),I=!(null===m||void 0===m||!m.outline),M=!(null===m||void 0===m||!m.crystalBackground),F=0!==n,O=[w,P,!T,!k][n||0],B="number"===typeof n&&n<3;console.log("isVisibleNext",B),console.log("step",n);const z=()=>w?!!P||(alert("Select a text color to continue"),l(1),!1):(alert("Please enter a text to continue"),l(0),!1);(0,r.useEffect)((()=>{null!==m&&void 0!==m&&m.key?i(!0):i(!1)}),[m]),(0,r.useEffect)((()=>(i(void 0!==(null===m||void 0===m?void 0:m.key)),()=>{i(!1)})),[]);const G=()=>{null!==m&&void 0!==m&&m.key&&o(m.key,{decalFreeze:!1,edit:!1,hasApplied:!0}),l(0),i(!1)},E=!localStorage.getItem("confirmCancelText"),[L,A]=(0,r.useState)(!1),V=()=>{null!==m&&void 0!==m&&m.key&&(G(),null===m||void 0===m||!m.text||null!==m&&void 0!==m&&m.hasApplied||u(m.key))},Z=["Font","Color","Outline","Finish"];return(0,x.jsx)(x.Fragment,{children:t?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:Re.navTextEdit,children:[(0,x.jsx)(xt,{mainTextInputRef:b,editText:m}),(0,x.jsx)(ft,{children:(()=>{const e=e=>{var t;("Outline"!==Z[e]&&"Finish"!==Z[e]||z())&&(null!==m&&void 0!==m&&m.text?l((t=e)===n?void 0:t):alert("Please enter a text to continue"))},t=[w,P,I,M];return Z.map(((i,a)=>{const l="\n        ".concat(n===a?Re.selectedCategoryItem:"","\n        ").concat(t[a]?Re.finishedCategoryItem:"","\n      ");return(0,x.jsx)("div",{className:l,onClick:()=>e(a),children:i},a)}))})()}),(()=>{switch(n){case 0:return(0,x.jsx)(Qe,{editText:m});case 1:return(0,x.jsx)(Ue,{editText:m});case 2:return(0,x.jsx)(Ye,{editText:m,setIsPickingOutline:f});case 3:return(0,x.jsx)(Xe,{setIsPickingCrystal:y,editText:m})}})(),(0,x.jsx)(bt,{onClickNext:()=>{if(void 0===n)l(0);else if(n<3){switch(n){case 0:if(null===m||void 0===m||!m.text)return void alert("Please enter a text to continue");break;case 1:if(null===m||void 0===m||!m.selectedName)return void alert("Select a text color type");if(null===m||void 0===m||!m.material)return void alert("Select a color for text");break;case 2:if(p&&(null===m||void 0===m||!m.outline))return void alert("Select an outline")}console.log("editText",m),l(n+1)}},onClickPrev:()=>{void 0===n?l(0):n>0&&l(n-1)},onClickCancel:()=>{null!==m&&void 0!==m&&m.text?A(!0):V()},onClickSave:()=>{C&&k?alert("Select a crystal type"):(null===m||void 0===m||!m.key||null!==m&&void 0!==m&&m.decalPosition||o(m.key,{decalFreeze:!0,decalPosition:[-.01989325641440387,2.436930108198209,1.6226380277735046],decalOrientation:[-.14799034762565572,-.17866277612764514,-.026487426629834374,"XYZ"]}),v(!0))},isVisiblePrev:F,isVisibleNext:B,isClickableNext:O}),(null===m||void 0===m?void 0:m.key)&&m.decalPosition&&(0,x.jsx)(H,{scale:null===m||void 0===m?void 0:m.decalScale,rotation:null===m||void 0===m?void 0:m.decalRotation,onScale:e=>{(0,r.startTransition)((()=>{null!==m&&void 0!==m&&m.key&&o(m.key,{decalScale:Number(e)})}))},onRotate:e=>{(0,r.startTransition)((()=>{null!==m&&void 0!==m&&m.key&&o(m.key,{decalRotation:Number(e)})}))}}),m&&h&&j&&S&&(0,c.createPortal)((0,x.jsx)(_,{onClick:()=>{if(!z())return v(!1);G(),v(!1)},classNames:Re.navHeaderSaveText,children:"SAVE"}),j),N&&(0,c.createPortal)((0,x.jsx)(kt,{ref:b,editText:m}),N)]}),N&&E&&L&&(0,c.createPortal)((0,x.jsx)(g,{cb:V,setShowNotification:A,notifName:"editTextCancelText",children:(0,x.jsx)("span",{children:"Cancel text customization?"})}),N)]}):(0,x.jsx)(x.Fragment,{children:(0,x.jsx)($e,{onAddTextClicked:()=>{i(!0)}})})})},wt={root:"CustomiserNav_root__rgnWr",open:"CustomiserNav_open__6TgJc",isFullscreen:"CustomiserNav_isFullscreen__xo92v",minimized:"CustomiserNav_minimized__-4C1L",actions:"CustomiserNav_actions__B0fm0",content:"CustomiserNav_content__whsIx",headerAfter:"CustomiserNav_headerAfter__bXrUD",navHeaderScroll:"CustomiserNav_navHeaderScroll__0nzPV",tab:"CustomiserNav_tab__El9gn",navName:"CustomiserNav_navName__YLBS9",selected:"CustomiserNav_selected__x6zsL",dot:"CustomiserNav_dot__FGM8D",finished:"CustomiserNav_finished__aPBu9",hasActions:"CustomiserNav_hasActions__xe43g",isEdittingText:"CustomiserNav_isEdittingText__bI3ZI",closed:"CustomiserNav_closed__fkIqu"},Pt=e=>{let{styles:t,finishedNavs:i,setFinishedNavs:n}=e;const{navItems:l,selectedNav:s,setSelectedNav:o,deleteText:u,flags:v,sizing:h}=(0,a.b)(),m=d("popupContainer"),[p,f]=(0,r.useState)(!1),{texts:_,updateText:C,parts:y}=(0,a.b)((e=>e)),j=null===_||void 0===_?void 0:_.find((e=>e.edit)),N=l.findIndex((e=>e.name===(null===s||void 0===s?void 0:s.name)));(0,r.useEffect)((()=>{const e=y.map((e=>{const t=e.part.name;if(!t)return;const i=!!l.find((e=>e.name===t));return{name:t,isFinished:i}}));n((t=>{var a,n;const l=[...t,...e,...i||[]];v.length?l.unshift({name:"Flags",isFinished:!0}):l.map((e=>{"Flags"===(null===e||void 0===e?void 0:e.name)&&(e.isFinished=!1)})),null!==h&&void 0!==h&&null!==(a=h.height)&&void 0!==a&&a.value&&null!==h&&void 0!==h&&null!==(n=h.weight)&&void 0!==n&&n.value?l.unshift({name:"Size",isFinished:!0}):l.map((e=>{"Size"===(null===e||void 0===e?void 0:e.name)&&(e.isFinished=!1)}));return l.filter(((e,t,i)=>i.findIndex((t=>(null===t||void 0===t?void 0:t.name)===(null===e||void 0===e?void 0:e.name)))===t))}))}),[y,v,h]),(0,r.useEffect)((()=>{if(_.length>0){-1===i.findIndex((e=>"Text"===(null===e||void 0===e?void 0:e.name)))?i.push({name:"Text",isFinished:!0}):i.map((e=>{"Text"===(null===e||void 0===e?void 0:e.name)&&(e.isFinished=!0)}))}else i.map((e=>{0===_.length&&"Text"===(null===e||void 0===e?void 0:e.name)&&(e.isFinished=!1)}))}),[_]);const b=e=>{if(!e)return;const t=i.find((t=>t&&t.name===e));return t?t.isFinished:void 0},T=!localStorage.getItem("navConfirmText");return m?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:null===t||void 0===t?void 0:t.navHeaderScroll,children:l.map(((e,i)=>{const a="\n            ".concat((null===s||void 0===s?void 0:s.name)===e.name?null===t||void 0===t?void 0:t.selected:"","\n            ").concat(null===t||void 0===t?void 0:t.tab,"\n          ");return(0,x.jsxs)("div",{className:a,onClick:()=>((e,t)=>{e!==N&&(null!==j&&void 0!==j&&j.text&&t&&"text"!==(null===t||void 0===t?void 0:t.toLowerCase())?f(!0):o(e))})(i,e.name),children:[(0,x.jsx)("span",{className:"".concat(null===t||void 0===t?void 0:t.dot," ").concat(b(e.name)&&(null===t||void 0===t?void 0:t.finished))}),(0,x.jsx)("span",{className:null===t||void 0===t?void 0:t.navName,children:e.name})]},i)}))}),p&&T&&(0,c.createPortal)((0,x.jsx)(g,{cb:()=>{null!==j&&void 0!==j&&j.key&&(C(j.key,{decalFreeze:!1,edit:!1,hasApplied:!0}),null!==j&&void 0!==j&&j.hasApplied||u(null===j||void 0===j?void 0:j.key)),o(N)},setShowNotification:f,notifName:"navConfirmText",children:(0,x.jsx)("span",{children:"Cancel text customization?"})}),m)]}):null},It=e=>{let{className:t,focusCameraOnPart:i}=e;const[n,d]=(0,r.useState)(!1),[c,u]=(0,r.useState)({left:0,top:0}),[v,h]=(0,r.useState)(!1),[m,p]=(0,r.useState)([]);console.log("finishedNavs",m);const{selectedPart:g,selectedNav:f,texts:_,isMinimizedCustomiserNav:C,updateIsMinimizedCustomiserNav:y}=(0,a.b)(),j=(0,r.useRef)(null),N=(0,r.useMemo)((()=>null===_||void 0===_?void 0:_.find((e=>e.edit))),[_]),b=((0,r.useMemo)((()=>"Text"===(null===f||void 0===f?void 0:f.name)&&N),[f,N]),l()(wt.root,{[wt.minimized]:C,[wt.hasActions]:null===f||void 0===f?void 0:f.hasActions,[wt.isEdittingText]:(null===N||void 0===N?void 0:N.text)&&v,[wt.isFullscreen]:!1},t));(0,r.useEffect)((()=>{n&&j.current&&j.current.scrollTo({...c,behavior:"instant"})}),[n]);const k=()=>{n&&j.current&&u({left:j.current.scrollLeft,top:j.current.scrollTop}),d(!n)};return(0,r.useEffect)((()=>{null===f&&null===g?d(!0):(d(!1),y(!1))}),[g,f]),(0,x.jsxs)(s.E.nav,{layout:"preserve-aspect",transition:{type:"spring",stiffness:700,damping:40},className:b,children:[(0,x.jsx)(J,{className:wt.header,toggle:()=>k(),isOpen:n,onClick:()=>{y(!C)},isMinimized:C}),(0,x.jsx)(Pt,{finishedNavs:m,setFinishedNavs:p,styles:wt}),(0,x.jsx)("div",{id:"NavHeaderAfter",className:wt.headerAfter}),(0,x.jsx)(r.Suspense,{fallback:(0,x.jsx)("div",{style:{background:"white"},children:"Loading..."}),children:(0,x.jsx)(o.M,{initial:!1,children:(0,x.jsx)(s.E.div,{id:"scrollable",className:"".concat(wt.content," ").concat(n&&wt.closed),initial:"collapsed",animate:"open",exit:"collapsed",variants:{open:{opacity:1},collapsed:{opacity:0}},ref:e=>{j.current=e},children:n?null:"fitting"===(null===f||void 0===f?void 0:f.type)?(0,x.jsx)(T,{finishedNavs:m,setFinishedNavs:p,focusCameraOnPart:i}):"names"===(null===f||void 0===f?void 0:f.type)?(0,x.jsx)(St,{showEditText:v,setShowEditText:h}):"flags"===(null===f||void 0===f?void 0:f.type)?(0,x.jsx)(X,{}):"images"===(null===f||void 0===f?void 0:f.type)?(0,x.jsx)(ne,{}):"size"===(null===f||void 0===f?void 0:f.type)?(0,x.jsx)(De,{}):g?(0,x.jsx)(Me,{part:g}):null})})}),!n&&(null===f||void 0===f?void 0:f.hasActions)&&(0,x.jsxs)("div",{className:wt.actions,children:[g&&(0,x.jsx)("div",{id:"CustomiserNavMaterial",style:{background:"white"}}),(0,x.jsx)("div",{id:"CustomiserNavActions"})]})]})};var Mt=i(9389);const Ft="Header_root__cz6kt",Ot="Header_total__nSueF",Bt="Header_price__GikHZ",zt="Header_resetBtn__yzIQA",Gt="Header_addToBasket__T8GpW",Et=e=>{let{className:t}=e;const i=l()(Ft,t),n=(0,a.b)((e=>e.total())),s=(0,a.b)((e=>e.designComplete())),o=(0,Mt.H)((e=>e.setResetCamera)),r=(0,Mt.H)((e=>e.addingToCart)),d=(0,a.b)((e=>e.resetCustomerSelections));return(0,x.jsxs)("div",{className:i,children:[(0,x.jsx)("div",{id:"reset-btn-container",className:zt,children:(0,x.jsx)(M.Z,{onClick:()=>{confirm("Reset everything?")&&d()},children:"CLEAR"})}),(0,x.jsxs)("div",{className:Ot,children:["Current ",(0,x.jsx)(qe,{className:Bt,priceString:n})]}),(0,x.jsx)(M.Z,{className:Gt,onClick:()=>{o()},disabled:!s||r,children:r?"Saving":"Add to basket"})]})},Ht="Customiser_root__+9xV1",Lt="Customiser_nav__xnqzP",At="Customiser_modelContainer__FVL2o",Vt="Customiser_model__jxaOf",Zt="Customiser_controls__Ar93L",Dt="Customiser_background__qq7nU",Rt="Customiser_loading__vNYyO",Wt="Customiser_header__1SFjA",qt="Customiser_close__sH1pv";var Xt=i(524);const Ut=(0,r.lazy)((()=>i.e(353).then(i.bind(i,353)))),Yt=[-.95422573319504,-.8257934547233227,.48109793465966844],Kt=e=>{let{className:t}=e;const i=(0,Mt.H)((e=>e.setShow)),{selectedNav:n,remountTrigger:s}=(0,a.b)(),o=(0,r.useRef)(null),d=l()(Ht,t,{});return(0,x.jsxs)("div",{className:d,children:[(0,x.jsx)("div",{id:"popupContainer",style:{position:"absolute",zIndex:"201"}}),(0,x.jsx)(It,{className:Lt,focusCameraOnPart:e=>{const t=e=>{const t=o.current;t&&t.position.set(e[0],e[1],e[2])};if("leg cut"===(e&&e.toLowerCase()))t(Yt);else t(Xt.Q)}}),(0,x.jsx)(Et,{className:Wt}),(0,x.jsxs)("svg",{className:Dt,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 114.383 97.088",children:[(0,x.jsx)("defs",{children:(0,x.jsx)("clipPath",{id:"a",children:(0,x.jsx)("path",{d:"M0 0h114.383v97.088H0z"})})}),(0,x.jsxs)("g",{clipPath:"url(#a)",fillRule:"evenodd",children:[(0,x.jsx)("path",{fill:"#e7e6e6",d:"M8.567 88.645v-.044c1.487-.24 2.986-.466 4.472-.716a1.278 1.278 0 0 0 .743-1.862 1.019 1.019 0 0 0-.949-.409c-2.928.338-5.845.747-8.785 1.147-.492.069-.709.447-.687 1.262.012 1.216.126 1.481.721 1.375 1.5-.243 3.008-.506 4.484-.753M23.905 77.54c-1.224.072-1.842.39-1.9 2.044a69.405 69.405 0 0 0 .011 5.312c.057 1.481.606 2.112 1.716 1.99q4.444-.488 8.888-1.012a1.851 1.851 0 0 0 1.659-1.975c.057-.853.1-1.709.1-2.562.023-.856.023-1.247 0-2.093-.068-1.6-.755-1.769-2.024-1.7Zm9.982-6.006c2.119 0 3.229 1.3 3.744 3.247a8.461 8.461 0 0 1 .32 2.222 225.099 225.099 0 0 1 0 7.896 8.3 8.3 0 0 1-.869 3.622 3.721 3.721 0 0 1-2.8 2.269c-4.072.553-8.121 1.15-12.182 1.784-1.773.306-3.145-1.253-3.523-3.993a25.755 25.755 0 0 1-.229-3.54c-.011-1.275-.006-2.556 0-3.834s.046-2.562.115-3.834c.091-1.944.606-4.015 1.887-5.128a2.565 2.565 0 0 1 1.533-.709Zm61.427 6.006v-6.006h13.325c1.682-.069 2.768 1.381 3.409 3.771a16.91 16.91 0 0 1 .538 4.281 18.216 18.216 0 0 1-.515 4.3 5.807 5.807 0 0 1-1.945 3.4c-.217.181-.469.34-.652.472.8 1.45 1.611 2.926 2.4 4.443a883.295 883.295 0 0 1 2.505 4.856c-.743-.163-1.453-.331-2.139-.472-1.041-.219-2.1-.381-3.157-.644a1.328 1.328 0 0 1-.732-.643c-.641-1.2-1.285-2.373-1.933-3.55-.633-1.148-1.292-2.3-1.91-3.431-.309-.522-.606-.819-1.041-.862a90.174 90.174 0 0 1-3.74-.481c-.366-.056-.481.116-.481.656.011 1.04.011 2.081.011 3.128v3.172c-1.235-.228-2.7-.472-3.946-.691v-12.17c3.752.156 7.526.293 11.278.4.492.013 1-.006 1.487 0 .56.016.789-.769.881-1.541.091-1.2-.149-2.053-.686-2.234a3.757 3.757 0 0 0-1.19-.16Zm-11.255 0v2.709l9.585.616v4.047l-9.631-.944v2.3l9.631 1.065v5.58c-4.838-.834-8.59-1.4-13.429-2.08v-19.3h13.431v6.006ZM37.072 90.367a232.526 232.526 0 0 1 3.775-5.125 219.554 219.554 0 0 1 3.786-4.809c-1.281-1.453-2.562-2.919-3.832-4.415s-2.439-2.915-3.709-4.484h5.5a1.331 1.331 0 0 1 .881.488c.7.84 1.322 1.559 2.02 2.375s1.407 1.625 2.116 2.431c.709-.84 1.417-1.682 2.127-2.512s1.413-1.643 2.128-2.466a.948.948 0 0 1 .652-.316h5.322c-1.224 1.384-2.475 2.827-3.7 4.237s-2.448 2.853-3.672 4.287c1.3 1.472 2.628 2.933 3.935 4.387s2.619 2.919 3.924 4.409c-1.865-.006-3.741.028-5.6.091a1.194 1.194 0 0 1-.789-.422q-1.116-1.213-2.23-2.434c-.732-.8-1.476-1.625-2.208-2.45-.755.928-1.511 1.855-2.265 2.8s-1.5 1.913-2.253 2.9c-.106.138-.274.327-.423.344-1.818.208-3.66.434-5.479.685m21.618-1.509c1.258-1.422 2.528-2.816 3.786-4.215s2.516-2.809 3.775-4.218q-1.922-2.231-3.832-4.428c-1.273-1.46-2.615-2.993-3.884-4.462h5.412a1.339 1.339 0 0 1 .881.459c.7.8 1.59 1.79 2.282 2.594s1.407 1.637 2.116 2.456c.709-.822 1.422-1.647 2.128-2.481s1.557-1.842 2.268-2.7a.959.959 0 0 1 .64-.34c1.773-.006 3.534 0 5.319.012-1.235 1.516-2.584 3.175-3.812 4.64s-2.459 2.884-3.683 4.293a234.511 234.511 0 0 1 3.935 4.959 262.195 262.195 0 0 1 3.935 5.293 296.137 296.137 0 0 0-5.6-.772 1.472 1.472 0 0 1-.8-.569c-.739-.948-1.48-1.9-2.219-2.822s-1.487-1.831-2.219-2.725q-1.132 1.247-2.253 2.49c-.749.829-1.511 1.652-2.265 2.478-.1.115-.274.26-.412.253a205.452 205.452 0 0 0-5.49-.2m-43.271-6.7a3.858 3.858 0 0 1 1.979 2.993 11.586 11.586 0 0 1-.24 5.3c-.549 1.89-1.6 3-2.962 3.29C9.494 94.797 4.8 95.888.1 97.088a.159.159 0 0 1-.1-.05V81.205c.274-.019.572-.041.881-.066 3.763-.328 7.5-.656 11.255-.981.377-.031.789 0 1.018-.622.32-.9-.034-2.037-.755-2H0V71.53h12.857a3.24 3.24 0 0 1 3.2 1.944 9.3 9.3 0 0 1 .721 4.4 8.384 8.384 0 0 1-1.361 4.277"}),(0,x.jsx)("path",{fill:"#e7e6e6",d:"m75.165 48.1-6.079-9.03v.049c-.057 1.036-.095 2.076-.183 3.112a2.019 2.019 0 0 1-.3.929l-8.448 12.034c-.249.368-.854 1.239-1.255 1.374a.382.382 0 0 1-.448-.158 2.924 2.924 0 0 1-.17-1.252v-.015l.451-9.913a.888.888 0 0 1 .121-.521l6.771-9.393a1.068 1.068 0 0 0 0-1.4l-6.516-9.933a3.453 3.453 0 0 1-.372-1.536l-.564-9.434c-.136-2.082.98-1.647 2.035 0l9.86 15.392 5.074-7.607c.439-.71.756-1.16 1.67-1.2a28.863 28.863 0 0 0 6.026-.866 2.49 2.49 0 0 1 .955-.113.381.381 0 0 1 .292.365 7.753 7.753 0 0 1-1.169 2.293L74.64 33.912a.971.971 0 0 0-.011 1.253l8.1 12.066a7.386 7.386 0 0 1 1.192 2.336.379.379 0 0 1-.247.33 2.314 2.314 0 0 1-1.008-.05 43.691 43.691 0 0 0-6.495-.95c-.5-.024-.775-.421-1.012-.8m-17.2-18.084 2.675 4.223a.378.378 0 0 1-.005.42L57.97 38.64a.386.386 0 0 1-.639 0l-2.729-4a.379.379 0 0 1-.005-.426l2.719-4.206a.386.386 0 0 1 .65 0m-13.64-.628 10.716-16.367c.911-1.366 2.032-2.329 1.921 0l-.453 9.457a3.209 3.209 0 0 1-.565 1.514l-6.217 9.551c-.31.474-.372.717-.048 1.2l6.446 9.577a1.569 1.569 0 0 1 .389.861l.454 9.969v.025a3.345 3.345 0 0 1-.187 1.236.385.385 0 0 1-.494.158 4.869 4.869 0 0 1-1.172-1.361l-9.863-14.918c-.149.21-.3.418-.441.636-1.474 2.327-2.954 4.649-4.408 6.989a1.51 1.51 0 0 1-1.168.806h-.025a40.188 40.188 0 0 0-6.467 1.047 3.664 3.664 0 0 1-1.08.156.385.385 0 0 1-.325-.453 11.67 11.67 0 0 1 1.3-2.279L40.716 34.9a.978.978 0 0 0 0-1.256L32.349 21.23a8.345 8.345 0 0 1-1.185-2.257.382.382 0 0 1 .294-.383 2.706 2.706 0 0 1 .969.1c1.112.258 2.222.524 3.342.747a22.428 22.428 0 0 0 3.334.462c.711.032 1.093.653 1.429 1.19 1 1.6 2.087 3.16 3.146 4.727a3.685 3.685 0 0 1 .542 2.108ZM57.652 0 45.465 18.084a.386.386 0 0 1-.628.017c-1.5-2-2.426-3.151-5.06-3.4a68.259 68.259 0 0 1-11.375-2.346c-3.454-.947-6.874-2.013-10.321-2.979l16.621 24.707a.379.379 0 0 1 0 .426L19.854 57.187c3.235-.656 6.473-1.24 9.736-1.751 3.484-.546 6.978-1.03 10.465-1.553a6.441 6.441 0 0 0 4.394-2.608l.623-.841a.385.385 0 0 1 .633.019L57.652 68.8l11.947-18.351a.386.386 0 0 1 .633-.019l.623.841a6.442 6.442 0 0 0 4.394 2.608c3.488.523 6.982 1.007 10.465 1.553 3.263.511 6.5 1.095 9.736 1.751L80.601 34.51a.378.378 0 0 1 0-.426L97.225 9.376c-3.447.965-6.868 2.031-10.321 2.979A68.266 68.266 0 0 1 75.528 14.7c-2.635.249-3.557 1.4-5.06 3.4a.386.386 0 0 1-.628-.017Z"})]})]}),(0,x.jsxs)("div",{className:At,children:[(0,x.jsx)("div",{id:"CustomiserCanvasControls",className:Zt}),(0,x.jsx)(r.Suspense,{fallback:(0,x.jsx)("div",{className:Rt,children:"Loading ..."}),children:(0,x.jsx)(Ut,{className:Vt,onCameraRef:e=>{o.current=e}},s)})]}),null===n&&(0,x.jsx)(M.Z,{className:qt,onClick:()=>i(!1),children:"Close"})]})}},524:(e,t,i)=>{i.d(t,{Q:()=>b,Z:()=>T});var a=i(6015),n=i(4647),l=i(1418),s=i.n(l),o=i(2791),r=i(8148),d=i(1854);const c=async e=>fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});var u=i(4875),v=i(9389),h=i(3418),m=i(7760),p=i(7749),x=i(184);const g=e=>(0,o.forwardRef)(((t,i)=>(0,x.jsx)(o.Suspense,{fallback:(0,x.jsx)(x.Fragment,{}),children:(0,x.jsx)(e,{...t,ref:i})}))),f=(0,o.forwardRef)(((e,t)=>(0,x.jsxs)("mesh",{ref:t,visible:!1,scale:.1,children:[(0,x.jsx)("boxGeometry",{args:[1,1,200]}),(0,x.jsx)("meshNormalMaterial",{})]})));f.displayName="MouseHelper";const _=f,C="CustomiserCanvas_root__1vMOn",y=g((0,o.lazy)((()=>Promise.all([i.e(423),i.e(369)]).then(i.bind(i,9369))))),j=(e,t)=>{var i,a,n,l,s,o,r,d,c,u,v,h,m;return{customProduct:null===(i=e.customProduct)||void 0===i?void 0:i.id,parts:e.savedParts.map((e=>{var t,i;return{name:e.part.name,areaSize:null===(t=e.part.areaSize)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.id,material:e.material.id}})),texts:e.texts.map((e=>{var t,i,a,n,l;return{text:e.text,decalPosition:e.decalPosition,decalOrientation:e.decalOrientation,decalRotation:e.decalRotation,decalScale:e.decalScale,basePriceVariantId:null===(t=e.basePrice)||void 0===t?void 0:t.shopifyVariantId,letterPriceVariantId:null===(i=e.letterPrice)||void 0===i?void 0:i.shopifyVariantId,outlinePriceVariantId:null===(a=e.outlinePrice)||void 0===a?void 0:a.shopifyVariantId,puffPriceVariantId:null===(n=e.puffPrice)||void 0===n?void 0:n.shopifyVariantId,crystalPriceVariantId:null===(l=e.crystalPrice)||void 0===l?void 0:l.shopifyVariantId}})),flags:e.flags.map((e=>{var t,i;return{flag:null===(t=e.flag)||void 0===t?void 0:t.id,decalPosition:e.decalPosition,decalOrientation:e.decalOrientation,decalRotation:e.decalRotation,decalScale:e.decalScale,size:e.size,shopifyVariantId:null===(i=e.basePrice)||void 0===i?void 0:i.shopifyVariantId}})),graphics:e.graphics.map((e=>{var t,i;return{graphic:null===(t=e.graphic)||void 0===t?void 0:t.id,decalPosition:e.decalPosition,decalOrientation:e.decalOrientation,decalRotation:e.decalRotation,decalScale:e.decalScale,size:e.size,shopifyVariantId:null===(i=e.basePrice)||void 0===i?void 0:i.shopifyVariantId}})),images:t,sizing:{shopifyVariantId:null===(a=e.sizing)||void 0===a||null===(n=a.variation)||void 0===n?void 0:n.id,size:null===(l=e.sizing)||void 0===l?void 0:l.size,height:null===(s=e.sizing)||void 0===s||null===(o=s.height)||void 0===o||null===(r=o.value)||void 0===r?void 0:r.toString(),heightUnit:null===(d=e.sizing)||void 0===d||null===(c=d.height)||void 0===c?void 0:c.unit,weight:null===(u=e.sizing)||void 0===u||null===(v=u.weight)||void 0===v?void 0:v.value,weightUnit:null===(h=e.sizing)||void 0===h||null===(m=h.weight)||void 0===m?void 0:m.unit}}},N=e=>{var t,i,a,n,l;const s=null===e||void 0===e?void 0:e.id,o=null===e||void 0===e?void 0:e.attributes;if(!o||!s)return[];const r=[],d=e=>null===e||void 0===e?void 0:e.replace("gid://shopify/ProductVariant/",""),c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i=(e=>r.find((t=>t.id===e)))(e);if(i){const e=i.quantity+t;i.quantity=e,i.properties._customDesignQuantity=e}else r.push({id:e,quantity:t,properties:{_customDesignAddon:s,_customDesignQuantity:t}})};return null!==(t=o.parts)&&void 0!==t&&t.length&&o.parts.forEach((e=>{const t=d(null===e||void 0===e?void 0:e.shopifyVariantId);t&&c(t)})),null!==(i=o.flags)&&void 0!==i&&i.length&&o.flags.forEach((e=>{const t=d(null===e||void 0===e?void 0:e.shopifyVariantId);t&&c(t)})),null!==(a=o.graphics)&&void 0!==a&&a.length&&o.graphics.forEach((e=>{const t=d(null===e||void 0===e?void 0:e.shopifyVariantId);t&&c(t)})),null!==(n=o.texts)&&void 0!==n&&n.length&&o.texts.forEach((e=>{var t;const i=d(null===e||void 0===e?void 0:e.basePriceVariantId);i&&c(i);const a=d(null===e||void 0===e?void 0:e.letterPriceVariantId);a&&c(a,null===e||void 0===e||null===(t=e.text)||void 0===t?void 0:t.length);const n=d(null===e||void 0===e?void 0:e.outlinePriceVariantId);n&&c(n);const l=d(null===e||void 0===e?void 0:e.puffPriceVariantId);l&&c(l);const s=d(null===e||void 0===e?void 0:e.crystalPriceVariantId);s&&c(s)})),null!==(l=o.sizing)&&void 0!==l&&l.shopifyVariantId&&r.push({id:d(o.sizing.shopifyVariantId),quantity:1,properties:{_customDesign:s}}),r},b=[0,21970893240496195e-31,15.31024512625285],T=e=>{let{className:t,style:i,onCameraRef:l}=e;const g=(0,o.useRef)(null),f=(0,o.useRef)(null),T=(0,o.useRef)([]),k=(0,o.useRef)(new m.Vector3),S=(0,o.useRef)(new m.Euler),w=(0,o.useRef)(null),P=(0,u.b)((e=>e.flags.find((e=>e.edit)))),I=(0,u.b)((e=>e.texts.find((e=>e.edit)))),M=(0,u.b)((e=>e.graphics.find((e=>e.edit)))),F=(0,u.b)((e=>e.updateGraphic)),O=(0,u.b)((e=>e.updateFlag)),B=(0,u.b)((e=>e.updateText)),z=(0,u.b)((e=>e.setCanvasSize)),G=(0,v.H)((e=>e.resetCamera)),E=(0,v.H)((e=>e.addingToCart)),H=(0,v.H)((e=>e.modelRotation)),L=(0,v.H)((e=>e.setAddingToCart)),A=(0,v.H)((e=>e.setModelRotation)),V=(0,u.b)((e=>e.reset)),Z=s()(C,t),D=(0,o.useRef)(null),R=(0,u.b)((e=>e)),[W,q]=(0,o.useState)(!1),[X,U]=(0,o.useState)(!1),Y=(0,o.useCallback)((e=>{var t;const i=e.point,a=null===e||void 0===e||null===(t=e.face)||void 0===t?void 0:t.normal.clone();D.current&&a&&w.current&&(a.transformDirection(w.current.matrixWorld),a.multiplyScalar(10),a.add(i),D.current.position.copy(i),D.current.lookAt(a))}),[D]),K=(0,o.useCallback)((e=>{q(!1),U(!1),W&&!X&&(null!==P&&void 0!==P&&P.key&&(e.stopPropagation(),O(P.key,{decalFreeze:!0}),Y(e),D.current&&k.current&&S.current&&(k.current.copy(e.point),S.current.copy(D.current.rotation),O(P.key,{decalPosition:k.current.clone().toArray(),decalOrientation:S.current.clone().toArray()}))),null!==M&&void 0!==M&&M.key&&(e.stopPropagation(),F(M.key,{decalFreeze:!0}),Y(e),D.current&&k.current&&S.current&&(k.current.copy(e.point),S.current.copy(D.current.rotation),F(M.key,{decalPosition:k.current.clone().toArray(),decalOrientation:S.current.clone().toArray()}))),null!==I&&void 0!==I&&I.key&&(e.stopPropagation(),B(I.key,{decalFreeze:!0}),Y(e),D.current&&k.current&&S.current&&(k.current.copy(e.point),S.current.copy(D.current.rotation),B(I.key,{decalPosition:k.current.clone().toArray(),decalOrientation:S.current.clone().toArray()}))))}),[P,M,I,W,X]),Q=(0,o.useCallback)((()=>{q(!0)}),[]),J=(0,o.useCallback)((e=>{q((e=>(e&&U(!0),e)))}),[W]),$=(0,h.D)({mutationFn:c,onSuccess:()=>{window.location.href=window.Shopify.routes.root+"cart",V()}}),{mutate:ee}=(0,r.ZF)(d.SL,{onSuccess(e){var t;if(null!==(t=e.createCustomDesign)&&void 0!==t&&t.data){const t=N(e.createCustomDesign.data);$.mutate({items:t})}}}),{mutateAsync:te}=(0,r.a1)(d.SL,{onSuccess(e){const t=e.multipleUpload.map((e=>{var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.id}));ee({data:j(R,t)})}});(0,o.useEffect)((()=>{if(E&&H<360)setTimeout((()=>{var e;null===f||void 0===f||null===(e=f.current)||void 0===e||e.toBlob((e=>{if(e){const t=new File([e],"fileName.png",{type:"image/png"});T.current.push(t),A(H+90)}}),"image/png")}),50);else if(E){(async()=>{await te({files:T.current})})()}}),[H,E,T]),(0,o.useEffect)((()=>{const e=g.current;e&&G&&(e.position.set(b[0],b[1],b[2]),L())}),[G]),(0,o.useEffect)((()=>{l&&g.current&&l(g.current)}),[l]);const ie=P||M||I;return(0,x.jsx)("div",{className:Z,style:i,children:(0,x.jsxs)(n.Xz,{linear:!0,flat:!0,camera:{position:b,fov:45},dpr:window.devicePixelRatio,gl:{preserveDrawingBuffer:!0},ref:f,onCreated:e=>{z(e.size.width,e.size.height),g.current=e.camera},frameloop:"demand",children:[(0,x.jsx)(y,{onClick:K,onPointerDown:Q,onPointerMove:J,ref:w}),(0,x.jsx)(p.Z,{}),ie&&(0,x.jsx)(_,{ref:D}),(0,x.jsx)(a.z,{enableZoom:!0,maxDistance:50,minDistance:5,minPolarAngle:Math.PI/3,maxPolarAngle:Math.PI/1.9,enableDamping:!1})]})})}},7749:(e,t,i)=>{i.d(t,{Z:()=>o});var a=i(2791),n=i(7760),l=i(184);const s={intensity:.1},o=(new n.Vector3(0,6,-200),new n.Vector3(-150,0,200),new n.Vector3(100,0,200),()=>{(0,a.useRef)(null);return(0,l.jsxs)("group",{children:[(0,l.jsx)("hemisphereLight",{...s}),(0,l.jsx)("pointLight",{position:[-800,0,-1e3],intensity:.5,decay:12,power:7,castShadow:!0}),(0,l.jsx)("pointLight",{position:[-800,0,1e3],intensity:.5,decay:12,power:7,castShadow:!0}),(0,l.jsx)("pointLight",{position:[800,0,1e3],intensity:.5,decay:120,power:7,castShadow:!0}),(0,l.jsx)("pointLight",{position:[800,0,-1e3],intensity:.5,decay:12,power:7,castShadow:!0})]})})}}]);
//# sourceMappingURL=88.f0b552e1.chunk.js.map